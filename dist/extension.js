"use strict";var Bn=Object.create;var pe=Object.defineProperty;var Hn=Object.getOwnPropertyDescriptor;var Yn=Object.getOwnPropertyNames;var Vn=Object.getPrototypeOf,zn=Object.prototype.hasOwnProperty;var Gn=(e,n)=>{for(var i in n)pe(e,i,{get:n[i],enumerable:!0})},Be=(e,n,i,r)=>{if(n&&typeof n=="object"||typeof n=="function")for(let t of Yn(n))!zn.call(e,t)&&t!==i&&pe(e,t,{get:()=>n[t],enumerable:!(r=Hn(n,t))||r.enumerable});return e};var Se=(e,n,i)=>(i=e!=null?Bn(Vn(e)):{},Be(n||!e||!e.__esModule?pe(i,"default",{value:e,enumerable:!0}):i,e)),qn=e=>Be(pe({},"__esModule",{value:!0}),e);var Ot={};Gn(Ot,{activate:()=>At,deactivate:()=>It});module.exports=qn(Ot);var p=Se(require("vscode")),Rn=require("child_process"),Ne=require("fs/promises"),$e=require("fs"),Ln=require("util");function sn(e){return typeof e>"u"||e===null}function Qn(e){return typeof e=="object"&&e!==null}function Jn(e){return Array.isArray(e)?e:sn(e)?[]:[e]}function Xn(e,n){var i,r,t,s;if(n)for(s=Object.keys(n),i=0,r=s.length;i<r;i+=1)t=s[i],e[t]=n[t];return e}function Zn(e,n){var i="",r;for(r=0;r<n;r+=1)i+=e;return i}function ei(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}var ni=sn,ii=Qn,ri=Jn,ti=Zn,oi=ei,si=Xn,F={isNothing:ni,isObject:ii,toArray:ri,repeat:ti,isNegativeZero:oi,extend:si};function cn(e,n){var i="",r=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(i+='in "'+e.mark.name+'" '),i+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!n&&e.mark.snippet&&(i+=`

`+e.mark.snippet),r+" "+i):r}function se(e,n){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=n,this.message=cn(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}se.prototype=Object.create(Error.prototype);se.prototype.constructor=se;se.prototype.toString=function(n){return this.name+": "+cn(this,n)};var P=se;function ke(e,n,i,r,t){var s="",o="",c=Math.floor(t/2)-1;return r-n>c&&(s=" ... ",n=r-c+s.length),i-r>c&&(o=" ...",i=r+c-o.length),{str:s+e.slice(n,i).replace(/\t/g,"\u2192")+o,pos:r-n+s.length}}function Ae(e,n){return F.repeat(" ",n-e.length)+e}function ci(e,n){if(n=Object.create(n||null),!e.buffer)return null;n.maxLength||(n.maxLength=79),typeof n.indent!="number"&&(n.indent=1),typeof n.linesBefore!="number"&&(n.linesBefore=3),typeof n.linesAfter!="number"&&(n.linesAfter=2);for(var i=/\r?\n|\r|\0/g,r=[0],t=[],s,o=-1;s=i.exec(e.buffer);)t.push(s.index),r.push(s.index+s[0].length),e.position<=s.index&&o<0&&(o=r.length-2);o<0&&(o=r.length-1);var c="",a,d,w=Math.min(e.line+n.linesAfter,t.length).toString().length,g=n.maxLength-(n.indent+w+3);for(a=1;a<=n.linesBefore&&!(o-a<0);a++)d=ke(e.buffer,r[o-a],t[o-a],e.position-(r[o]-r[o-a]),g),c=F.repeat(" ",n.indent)+Ae((e.line-a+1).toString(),w)+" | "+d.str+`
`+c;for(d=ke(e.buffer,r[o],t[o],e.position,g),c+=F.repeat(" ",n.indent)+Ae((e.line+1).toString(),w)+" | "+d.str+`
`,c+=F.repeat("-",n.indent+w+3+d.pos)+`^
`,a=1;a<=n.linesAfter&&!(o+a>=t.length);a++)d=ke(e.buffer,r[o+a],t[o+a],e.position-(r[o]-r[o+a]),g),c+=F.repeat(" ",n.indent)+Ae((e.line+a+1).toString(),w)+" | "+d.str+`
`;return c.replace(/\n$/,"")}var ai=ci,li=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],ui=["scalar","sequence","mapping"];function fi(e){var n={};return e!==null&&Object.keys(e).forEach(function(i){e[i].forEach(function(r){n[String(r)]=i})}),n}function di(e,n){if(n=n||{},Object.keys(n).forEach(function(i){if(li.indexOf(i)===-1)throw new P('Unknown option "'+i+'" is met in definition of "'+e+'" YAML type.')}),this.options=n,this.tag=e,this.kind=n.kind||null,this.resolve=n.resolve||function(){return!0},this.construct=n.construct||function(i){return i},this.instanceOf=n.instanceOf||null,this.predicate=n.predicate||null,this.represent=n.represent||null,this.representName=n.representName||null,this.defaultStyle=n.defaultStyle||null,this.multi=n.multi||!1,this.styleAliases=fi(n.styleAliases||null),ui.indexOf(this.kind)===-1)throw new P('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}var _=di;function He(e,n){var i=[];return e[n].forEach(function(r){var t=i.length;i.forEach(function(s,o){s.tag===r.tag&&s.kind===r.kind&&s.multi===r.multi&&(t=o)}),i[t]=r}),i}function pi(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},n,i;function r(t){t.multi?(e.multi[t.kind].push(t),e.multi.fallback.push(t)):e[t.kind][t.tag]=e.fallback[t.tag]=t}for(n=0,i=arguments.length;n<i;n+=1)arguments[n].forEach(r);return e}function Oe(e){return this.extend(e)}Oe.prototype.extend=function(n){var i=[],r=[];if(n instanceof _)r.push(n);else if(Array.isArray(n))r=r.concat(n);else if(n&&(Array.isArray(n.implicit)||Array.isArray(n.explicit)))n.implicit&&(i=i.concat(n.implicit)),n.explicit&&(r=r.concat(n.explicit));else throw new P("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");i.forEach(function(s){if(!(s instanceof _))throw new P("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(s.loadKind&&s.loadKind!=="scalar")throw new P("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(s.multi)throw new P("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),r.forEach(function(s){if(!(s instanceof _))throw new P("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var t=Object.create(Oe.prototype);return t.implicit=(this.implicit||[]).concat(i),t.explicit=(this.explicit||[]).concat(r),t.compiledImplicit=He(t,"implicit"),t.compiledExplicit=He(t,"explicit"),t.compiledTypeMap=pi(t.compiledImplicit,t.compiledExplicit),t};var mi=Oe,gi=new _("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return e!==null?e:""}}),hi=new _("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return e!==null?e:[]}}),wi=new _("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return e!==null?e:{}}}),yi=new mi({explicit:[gi,hi,wi]});function vi(e){if(e===null)return!0;var n=e.length;return n===1&&e==="~"||n===4&&(e==="null"||e==="Null"||e==="NULL")}function Ci(){return null}function xi(e){return e===null}var bi=new _("tag:yaml.org,2002:null",{kind:"scalar",resolve:vi,construct:Ci,predicate:xi,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function Si(e){if(e===null)return!1;var n=e.length;return n===4&&(e==="true"||e==="True"||e==="TRUE")||n===5&&(e==="false"||e==="False"||e==="FALSE")}function ki(e){return e==="true"||e==="True"||e==="TRUE"}function Ai(e){return Object.prototype.toString.call(e)==="[object Boolean]"}var Ii=new _("tag:yaml.org,2002:bool",{kind:"scalar",resolve:Si,construct:ki,predicate:Ai,represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function Oi(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function Fi(e){return 48<=e&&e<=55}function Ti(e){return 48<=e&&e<=57}function Ei(e){if(e===null)return!1;var n=e.length,i=0,r=!1,t;if(!n)return!1;if(t=e[i],(t==="-"||t==="+")&&(t=e[++i]),t==="0"){if(i+1===n)return!0;if(t=e[++i],t==="b"){for(i++;i<n;i++)if(t=e[i],t!=="_"){if(t!=="0"&&t!=="1")return!1;r=!0}return r&&t!=="_"}if(t==="x"){for(i++;i<n;i++)if(t=e[i],t!=="_"){if(!Oi(e.charCodeAt(i)))return!1;r=!0}return r&&t!=="_"}if(t==="o"){for(i++;i<n;i++)if(t=e[i],t!=="_"){if(!Fi(e.charCodeAt(i)))return!1;r=!0}return r&&t!=="_"}}if(t==="_")return!1;for(;i<n;i++)if(t=e[i],t!=="_"){if(!Ti(e.charCodeAt(i)))return!1;r=!0}return!(!r||t==="_")}function _i(e){var n=e,i=1,r;if(n.indexOf("_")!==-1&&(n=n.replace(/_/g,"")),r=n[0],(r==="-"||r==="+")&&(r==="-"&&(i=-1),n=n.slice(1),r=n[0]),n==="0")return 0;if(r==="0"){if(n[1]==="b")return i*parseInt(n.slice(2),2);if(n[1]==="x")return i*parseInt(n.slice(2),16);if(n[1]==="o")return i*parseInt(n.slice(2),8)}return i*parseInt(n,10)}function Di(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!F.isNegativeZero(e)}var Pi=new _("tag:yaml.org,2002:int",{kind:"scalar",resolve:Ei,construct:_i,predicate:Di,represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),Ri=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function Li(e){return!(e===null||!Ri.test(e)||e[e.length-1]==="_")}function Mi(e){var n,i;return n=e.replace(/_/g,"").toLowerCase(),i=n[0]==="-"?-1:1,"+-".indexOf(n[0])>=0&&(n=n.slice(1)),n===".inf"?i===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:n===".nan"?NaN:i*parseFloat(n,10)}var ji=/^[-+]?[0-9]+e/;function Ni(e,n){var i;if(isNaN(e))switch(n){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(n){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(n){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(F.isNegativeZero(e))return"-0.0";return i=e.toString(10),ji.test(i)?i.replace("e",".e"):i}function $i(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||F.isNegativeZero(e))}var Ui=new _("tag:yaml.org,2002:float",{kind:"scalar",resolve:Li,construct:Mi,predicate:$i,represent:Ni,defaultStyle:"lowercase"}),Ki=yi.extend({implicit:[bi,Ii,Pi,Ui]}),Wi=Ki,an=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),ln=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function Bi(e){return e===null?!1:an.exec(e)!==null||ln.exec(e)!==null}function Hi(e){var n,i,r,t,s,o,c,a=0,d=null,w,g,y;if(n=an.exec(e),n===null&&(n=ln.exec(e)),n===null)throw new Error("Date resolve error");if(i=+n[1],r=+n[2]-1,t=+n[3],!n[4])return new Date(Date.UTC(i,r,t));if(s=+n[4],o=+n[5],c=+n[6],n[7]){for(a=n[7].slice(0,3);a.length<3;)a+="0";a=+a}return n[9]&&(w=+n[10],g=+(n[11]||0),d=(w*60+g)*6e4,n[9]==="-"&&(d=-d)),y=new Date(Date.UTC(i,r,t,s,o,c,a)),d&&y.setTime(y.getTime()-d),y}function Yi(e){return e.toISOString()}var Vi=new _("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:Bi,construct:Hi,instanceOf:Date,represent:Yi});function zi(e){return e==="<<"||e===null}var Gi=new _("tag:yaml.org,2002:merge",{kind:"scalar",resolve:zi}),De=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function qi(e){if(e===null)return!1;var n,i,r=0,t=e.length,s=De;for(i=0;i<t;i++)if(n=s.indexOf(e.charAt(i)),!(n>64)){if(n<0)return!1;r+=6}return r%8===0}function Qi(e){var n,i,r=e.replace(/[\r\n=]/g,""),t=r.length,s=De,o=0,c=[];for(n=0;n<t;n++)n%4===0&&n&&(c.push(o>>16&255),c.push(o>>8&255),c.push(o&255)),o=o<<6|s.indexOf(r.charAt(n));return i=t%4*6,i===0?(c.push(o>>16&255),c.push(o>>8&255),c.push(o&255)):i===18?(c.push(o>>10&255),c.push(o>>2&255)):i===12&&c.push(o>>4&255),new Uint8Array(c)}function Ji(e){var n="",i=0,r,t,s=e.length,o=De;for(r=0;r<s;r++)r%3===0&&r&&(n+=o[i>>18&63],n+=o[i>>12&63],n+=o[i>>6&63],n+=o[i&63]),i=(i<<8)+e[r];return t=s%3,t===0?(n+=o[i>>18&63],n+=o[i>>12&63],n+=o[i>>6&63],n+=o[i&63]):t===2?(n+=o[i>>10&63],n+=o[i>>4&63],n+=o[i<<2&63],n+=o[64]):t===1&&(n+=o[i>>2&63],n+=o[i<<4&63],n+=o[64],n+=o[64]),n}function Xi(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}var Zi=new _("tag:yaml.org,2002:binary",{kind:"scalar",resolve:qi,construct:Qi,predicate:Xi,represent:Ji}),er=Object.prototype.hasOwnProperty,nr=Object.prototype.toString;function ir(e){if(e===null)return!0;var n=[],i,r,t,s,o,c=e;for(i=0,r=c.length;i<r;i+=1){if(t=c[i],o=!1,nr.call(t)!=="[object Object]")return!1;for(s in t)if(er.call(t,s))if(!o)o=!0;else return!1;if(!o)return!1;if(n.indexOf(s)===-1)n.push(s);else return!1}return!0}function rr(e){return e!==null?e:[]}var tr=new _("tag:yaml.org,2002:omap",{kind:"sequence",resolve:ir,construct:rr}),or=Object.prototype.toString;function sr(e){if(e===null)return!0;var n,i,r,t,s,o=e;for(s=new Array(o.length),n=0,i=o.length;n<i;n+=1){if(r=o[n],or.call(r)!=="[object Object]"||(t=Object.keys(r),t.length!==1))return!1;s[n]=[t[0],r[t[0]]]}return!0}function cr(e){if(e===null)return[];var n,i,r,t,s,o=e;for(s=new Array(o.length),n=0,i=o.length;n<i;n+=1)r=o[n],t=Object.keys(r),s[n]=[t[0],r[t[0]]];return s}var ar=new _("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:sr,construct:cr}),lr=Object.prototype.hasOwnProperty;function ur(e){if(e===null)return!0;var n,i=e;for(n in i)if(lr.call(i,n)&&i[n]!==null)return!1;return!0}function fr(e){return e!==null?e:{}}var dr=new _("tag:yaml.org,2002:set",{kind:"mapping",resolve:ur,construct:fr}),un=Wi.extend({implicit:[Vi,Gi],explicit:[Zi,tr,ar,dr]}),Y=Object.prototype.hasOwnProperty,me=1,fn=2,dn=3,ge=4,Ie=1,pr=2,Ye=3,mr=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,gr=/[\x85\u2028\u2029]/,hr=/[,\[\]\{\}]/,pn=/^(?:!|!!|![a-z\-]+!)$/i,mn=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function Ve(e){return Object.prototype.toString.call(e)}function K(e){return e===10||e===13}function J(e){return e===9||e===32}function R(e){return e===9||e===32||e===10||e===13}function ie(e){return e===44||e===91||e===93||e===123||e===125}function wr(e){var n;return 48<=e&&e<=57?e-48:(n=e|32,97<=n&&n<=102?n-97+10:-1)}function yr(e){return e===120?2:e===117?4:e===85?8:0}function vr(e){return 48<=e&&e<=57?e-48:-1}function ze(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"\x85":e===95?"\xA0":e===76?"\u2028":e===80?"\u2029":""}function Cr(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}var gn=new Array(256),hn=new Array(256);for(Q=0;Q<256;Q++)gn[Q]=ze(Q)?1:0,hn[Q]=ze(Q);var Q;function xr(e,n){this.input=e,this.filename=n.filename||null,this.schema=n.schema||un,this.onWarning=n.onWarning||null,this.legacy=n.legacy||!1,this.json=n.json||!1,this.listener=n.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function wn(e,n){var i={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return i.snippet=ai(i),new P(n,i)}function C(e,n){throw wn(e,n)}function he(e,n){e.onWarning&&e.onWarning.call(null,wn(e,n))}var Ge={YAML:function(n,i,r){var t,s,o;n.version!==null&&C(n,"duplication of %YAML directive"),r.length!==1&&C(n,"YAML directive accepts exactly one argument"),t=/^([0-9]+)\.([0-9]+)$/.exec(r[0]),t===null&&C(n,"ill-formed argument of the YAML directive"),s=parseInt(t[1],10),o=parseInt(t[2],10),s!==1&&C(n,"unacceptable YAML version of the document"),n.version=r[0],n.checkLineBreaks=o<2,o!==1&&o!==2&&he(n,"unsupported YAML version of the document")},TAG:function(n,i,r){var t,s;r.length!==2&&C(n,"TAG directive accepts exactly two arguments"),t=r[0],s=r[1],pn.test(t)||C(n,"ill-formed tag handle (first argument) of the TAG directive"),Y.call(n.tagMap,t)&&C(n,'there is a previously declared suffix for "'+t+'" tag handle'),mn.test(s)||C(n,"ill-formed tag prefix (second argument) of the TAG directive");try{s=decodeURIComponent(s)}catch{C(n,"tag prefix is malformed: "+s)}n.tagMap[t]=s}};function H(e,n,i,r){var t,s,o,c;if(n<i){if(c=e.input.slice(n,i),r)for(t=0,s=c.length;t<s;t+=1)o=c.charCodeAt(t),o===9||32<=o&&o<=1114111||C(e,"expected valid JSON character");else mr.test(c)&&C(e,"the stream contains non-printable characters");e.result+=c}}function qe(e,n,i,r){var t,s,o,c;for(F.isObject(i)||C(e,"cannot merge mappings; the provided source object is unacceptable"),t=Object.keys(i),o=0,c=t.length;o<c;o+=1)s=t[o],Y.call(n,s)||(n[s]=i[s],r[s]=!0)}function re(e,n,i,r,t,s,o,c,a){var d,w;if(Array.isArray(t))for(t=Array.prototype.slice.call(t),d=0,w=t.length;d<w;d+=1)Array.isArray(t[d])&&C(e,"nested arrays are not supported inside keys"),typeof t=="object"&&Ve(t[d])==="[object Object]"&&(t[d]="[object Object]");if(typeof t=="object"&&Ve(t)==="[object Object]"&&(t="[object Object]"),t=String(t),n===null&&(n={}),r==="tag:yaml.org,2002:merge")if(Array.isArray(s))for(d=0,w=s.length;d<w;d+=1)qe(e,n,s[d],i);else qe(e,n,s,i);else!e.json&&!Y.call(i,t)&&Y.call(n,t)&&(e.line=o||e.line,e.lineStart=c||e.lineStart,e.position=a||e.position,C(e,"duplicated mapping key")),t==="__proto__"?Object.defineProperty(n,t,{configurable:!0,enumerable:!0,writable:!0,value:s}):n[t]=s,delete i[t];return n}function Pe(e){var n;n=e.input.charCodeAt(e.position),n===10?e.position++:n===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):C(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function O(e,n,i){for(var r=0,t=e.input.charCodeAt(e.position);t!==0;){for(;J(t);)t===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),t=e.input.charCodeAt(++e.position);if(n&&t===35)do t=e.input.charCodeAt(++e.position);while(t!==10&&t!==13&&t!==0);if(K(t))for(Pe(e),t=e.input.charCodeAt(e.position),r++,e.lineIndent=0;t===32;)e.lineIndent++,t=e.input.charCodeAt(++e.position);else break}return i!==-1&&r!==0&&e.lineIndent<i&&he(e,"deficient indentation"),r}function ve(e){var n=e.position,i;return i=e.input.charCodeAt(n),!!((i===45||i===46)&&i===e.input.charCodeAt(n+1)&&i===e.input.charCodeAt(n+2)&&(n+=3,i=e.input.charCodeAt(n),i===0||R(i)))}function Re(e,n){n===1?e.result+=" ":n>1&&(e.result+=F.repeat(`
`,n-1))}function br(e,n,i){var r,t,s,o,c,a,d,w,g=e.kind,y=e.result,f;if(f=e.input.charCodeAt(e.position),R(f)||ie(f)||f===35||f===38||f===42||f===33||f===124||f===62||f===39||f===34||f===37||f===64||f===96||(f===63||f===45)&&(t=e.input.charCodeAt(e.position+1),R(t)||i&&ie(t)))return!1;for(e.kind="scalar",e.result="",s=o=e.position,c=!1;f!==0;){if(f===58){if(t=e.input.charCodeAt(e.position+1),R(t)||i&&ie(t))break}else if(f===35){if(r=e.input.charCodeAt(e.position-1),R(r))break}else{if(e.position===e.lineStart&&ve(e)||i&&ie(f))break;if(K(f))if(a=e.line,d=e.lineStart,w=e.lineIndent,O(e,!1,-1),e.lineIndent>=n){c=!0,f=e.input.charCodeAt(e.position);continue}else{e.position=o,e.line=a,e.lineStart=d,e.lineIndent=w;break}}c&&(H(e,s,o,!1),Re(e,e.line-a),s=o=e.position,c=!1),J(f)||(o=e.position+1),f=e.input.charCodeAt(++e.position)}return H(e,s,o,!1),e.result?!0:(e.kind=g,e.result=y,!1)}function Sr(e,n){var i,r,t;if(i=e.input.charCodeAt(e.position),i!==39)return!1;for(e.kind="scalar",e.result="",e.position++,r=t=e.position;(i=e.input.charCodeAt(e.position))!==0;)if(i===39)if(H(e,r,e.position,!0),i=e.input.charCodeAt(++e.position),i===39)r=e.position,e.position++,t=e.position;else return!0;else K(i)?(H(e,r,t,!0),Re(e,O(e,!1,n)),r=t=e.position):e.position===e.lineStart&&ve(e)?C(e,"unexpected end of the document within a single quoted scalar"):(e.position++,t=e.position);C(e,"unexpected end of the stream within a single quoted scalar")}function kr(e,n){var i,r,t,s,o,c;if(c=e.input.charCodeAt(e.position),c!==34)return!1;for(e.kind="scalar",e.result="",e.position++,i=r=e.position;(c=e.input.charCodeAt(e.position))!==0;){if(c===34)return H(e,i,e.position,!0),e.position++,!0;if(c===92){if(H(e,i,e.position,!0),c=e.input.charCodeAt(++e.position),K(c))O(e,!1,n);else if(c<256&&gn[c])e.result+=hn[c],e.position++;else if((o=yr(c))>0){for(t=o,s=0;t>0;t--)c=e.input.charCodeAt(++e.position),(o=wr(c))>=0?s=(s<<4)+o:C(e,"expected hexadecimal character");e.result+=Cr(s),e.position++}else C(e,"unknown escape sequence");i=r=e.position}else K(c)?(H(e,i,r,!0),Re(e,O(e,!1,n)),i=r=e.position):e.position===e.lineStart&&ve(e)?C(e,"unexpected end of the document within a double quoted scalar"):(e.position++,r=e.position)}C(e,"unexpected end of the stream within a double quoted scalar")}function Ar(e,n){var i=!0,r,t,s,o=e.tag,c,a=e.anchor,d,w,g,y,f,l=Object.create(null),u,m,h,v;if(v=e.input.charCodeAt(e.position),v===91)w=93,f=!1,c=[];else if(v===123)w=125,f=!0,c={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=c),v=e.input.charCodeAt(++e.position);v!==0;){if(O(e,!0,n),v=e.input.charCodeAt(e.position),v===w)return e.position++,e.tag=o,e.anchor=a,e.kind=f?"mapping":"sequence",e.result=c,!0;i?v===44&&C(e,"expected the node content, but found ','"):C(e,"missed comma between flow collection entries"),m=u=h=null,g=y=!1,v===63&&(d=e.input.charCodeAt(e.position+1),R(d)&&(g=y=!0,e.position++,O(e,!0,n))),r=e.line,t=e.lineStart,s=e.position,te(e,n,me,!1,!0),m=e.tag,u=e.result,O(e,!0,n),v=e.input.charCodeAt(e.position),(y||e.line===r)&&v===58&&(g=!0,v=e.input.charCodeAt(++e.position),O(e,!0,n),te(e,n,me,!1,!0),h=e.result),f?re(e,c,l,m,u,h,r,t,s):g?c.push(re(e,null,l,m,u,h,r,t,s)):c.push(u),O(e,!0,n),v=e.input.charCodeAt(e.position),v===44?(i=!0,v=e.input.charCodeAt(++e.position)):i=!1}C(e,"unexpected end of the stream within a flow collection")}function Ir(e,n){var i,r,t=Ie,s=!1,o=!1,c=n,a=0,d=!1,w,g;if(g=e.input.charCodeAt(e.position),g===124)r=!1;else if(g===62)r=!0;else return!1;for(e.kind="scalar",e.result="";g!==0;)if(g=e.input.charCodeAt(++e.position),g===43||g===45)Ie===t?t=g===43?Ye:pr:C(e,"repeat of a chomping mode identifier");else if((w=vr(g))>=0)w===0?C(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):o?C(e,"repeat of an indentation width identifier"):(c=n+w-1,o=!0);else break;if(J(g)){do g=e.input.charCodeAt(++e.position);while(J(g));if(g===35)do g=e.input.charCodeAt(++e.position);while(!K(g)&&g!==0)}for(;g!==0;){for(Pe(e),e.lineIndent=0,g=e.input.charCodeAt(e.position);(!o||e.lineIndent<c)&&g===32;)e.lineIndent++,g=e.input.charCodeAt(++e.position);if(!o&&e.lineIndent>c&&(c=e.lineIndent),K(g)){a++;continue}if(e.lineIndent<c){t===Ye?e.result+=F.repeat(`
`,s?1+a:a):t===Ie&&s&&(e.result+=`
`);break}for(r?J(g)?(d=!0,e.result+=F.repeat(`
`,s?1+a:a)):d?(d=!1,e.result+=F.repeat(`
`,a+1)):a===0?s&&(e.result+=" "):e.result+=F.repeat(`
`,a):e.result+=F.repeat(`
`,s?1+a:a),s=!0,o=!0,a=0,i=e.position;!K(g)&&g!==0;)g=e.input.charCodeAt(++e.position);H(e,i,e.position,!1)}return!0}function Qe(e,n){var i,r=e.tag,t=e.anchor,s=[],o,c=!1,a;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=s),a=e.input.charCodeAt(e.position);a!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,C(e,"tab characters must not be used in indentation")),!(a!==45||(o=e.input.charCodeAt(e.position+1),!R(o))));){if(c=!0,e.position++,O(e,!0,-1)&&e.lineIndent<=n){s.push(null),a=e.input.charCodeAt(e.position);continue}if(i=e.line,te(e,n,dn,!1,!0),s.push(e.result),O(e,!0,-1),a=e.input.charCodeAt(e.position),(e.line===i||e.lineIndent>n)&&a!==0)C(e,"bad indentation of a sequence entry");else if(e.lineIndent<n)break}return c?(e.tag=r,e.anchor=t,e.kind="sequence",e.result=s,!0):!1}function Or(e,n,i){var r,t,s,o,c,a,d=e.tag,w=e.anchor,g={},y=Object.create(null),f=null,l=null,u=null,m=!1,h=!1,v;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=g),v=e.input.charCodeAt(e.position);v!==0;){if(!m&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,C(e,"tab characters must not be used in indentation")),r=e.input.charCodeAt(e.position+1),s=e.line,(v===63||v===58)&&R(r))v===63?(m&&(re(e,g,y,f,l,null,o,c,a),f=l=u=null),h=!0,m=!0,t=!0):m?(m=!1,t=!0):C(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,v=r;else{if(o=e.line,c=e.lineStart,a=e.position,!te(e,i,fn,!1,!0))break;if(e.line===s){for(v=e.input.charCodeAt(e.position);J(v);)v=e.input.charCodeAt(++e.position);if(v===58)v=e.input.charCodeAt(++e.position),R(v)||C(e,"a whitespace character is expected after the key-value separator within a block mapping"),m&&(re(e,g,y,f,l,null,o,c,a),f=l=u=null),h=!0,m=!1,t=!1,f=e.tag,l=e.result;else if(h)C(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=d,e.anchor=w,!0}else if(h)C(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=d,e.anchor=w,!0}if((e.line===s||e.lineIndent>n)&&(m&&(o=e.line,c=e.lineStart,a=e.position),te(e,n,ge,!0,t)&&(m?l=e.result:u=e.result),m||(re(e,g,y,f,l,u,o,c,a),f=l=u=null),O(e,!0,-1),v=e.input.charCodeAt(e.position)),(e.line===s||e.lineIndent>n)&&v!==0)C(e,"bad indentation of a mapping entry");else if(e.lineIndent<n)break}return m&&re(e,g,y,f,l,null,o,c,a),h&&(e.tag=d,e.anchor=w,e.kind="mapping",e.result=g),h}function Fr(e){var n,i=!1,r=!1,t,s,o;if(o=e.input.charCodeAt(e.position),o!==33)return!1;if(e.tag!==null&&C(e,"duplication of a tag property"),o=e.input.charCodeAt(++e.position),o===60?(i=!0,o=e.input.charCodeAt(++e.position)):o===33?(r=!0,t="!!",o=e.input.charCodeAt(++e.position)):t="!",n=e.position,i){do o=e.input.charCodeAt(++e.position);while(o!==0&&o!==62);e.position<e.length?(s=e.input.slice(n,e.position),o=e.input.charCodeAt(++e.position)):C(e,"unexpected end of the stream within a verbatim tag")}else{for(;o!==0&&!R(o);)o===33&&(r?C(e,"tag suffix cannot contain exclamation marks"):(t=e.input.slice(n-1,e.position+1),pn.test(t)||C(e,"named tag handle cannot contain such characters"),r=!0,n=e.position+1)),o=e.input.charCodeAt(++e.position);s=e.input.slice(n,e.position),hr.test(s)&&C(e,"tag suffix cannot contain flow indicator characters")}s&&!mn.test(s)&&C(e,"tag name cannot contain such characters: "+s);try{s=decodeURIComponent(s)}catch{C(e,"tag name is malformed: "+s)}return i?e.tag=s:Y.call(e.tagMap,t)?e.tag=e.tagMap[t]+s:t==="!"?e.tag="!"+s:t==="!!"?e.tag="tag:yaml.org,2002:"+s:C(e,'undeclared tag handle "'+t+'"'),!0}function Tr(e){var n,i;if(i=e.input.charCodeAt(e.position),i!==38)return!1;for(e.anchor!==null&&C(e,"duplication of an anchor property"),i=e.input.charCodeAt(++e.position),n=e.position;i!==0&&!R(i)&&!ie(i);)i=e.input.charCodeAt(++e.position);return e.position===n&&C(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(n,e.position),!0}function Er(e){var n,i,r;if(r=e.input.charCodeAt(e.position),r!==42)return!1;for(r=e.input.charCodeAt(++e.position),n=e.position;r!==0&&!R(r)&&!ie(r);)r=e.input.charCodeAt(++e.position);return e.position===n&&C(e,"name of an alias node must contain at least one character"),i=e.input.slice(n,e.position),Y.call(e.anchorMap,i)||C(e,'unidentified alias "'+i+'"'),e.result=e.anchorMap[i],O(e,!0,-1),!0}function te(e,n,i,r,t){var s,o,c,a=1,d=!1,w=!1,g,y,f,l,u,m;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,s=o=c=ge===i||dn===i,r&&O(e,!0,-1)&&(d=!0,e.lineIndent>n?a=1:e.lineIndent===n?a=0:e.lineIndent<n&&(a=-1)),a===1)for(;Fr(e)||Tr(e);)O(e,!0,-1)?(d=!0,c=s,e.lineIndent>n?a=1:e.lineIndent===n?a=0:e.lineIndent<n&&(a=-1)):c=!1;if(c&&(c=d||t),(a===1||ge===i)&&(me===i||fn===i?u=n:u=n+1,m=e.position-e.lineStart,a===1?c&&(Qe(e,m)||Or(e,m,u))||Ar(e,u)?w=!0:(o&&Ir(e,u)||Sr(e,u)||kr(e,u)?w=!0:Er(e)?(w=!0,(e.tag!==null||e.anchor!==null)&&C(e,"alias node should not have any properties")):br(e,u,me===i)&&(w=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):a===0&&(w=c&&Qe(e,m))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&C(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),g=0,y=e.implicitTypes.length;g<y;g+=1)if(l=e.implicitTypes[g],l.resolve(e.result)){e.result=l.construct(e.result),e.tag=l.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(Y.call(e.typeMap[e.kind||"fallback"],e.tag))l=e.typeMap[e.kind||"fallback"][e.tag];else for(l=null,f=e.typeMap.multi[e.kind||"fallback"],g=0,y=f.length;g<y;g+=1)if(e.tag.slice(0,f[g].tag.length)===f[g].tag){l=f[g];break}l||C(e,"unknown tag !<"+e.tag+">"),e.result!==null&&l.kind!==e.kind&&C(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+l.kind+'", not "'+e.kind+'"'),l.resolve(e.result,e.tag)?(e.result=l.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):C(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||w}function _r(e){var n=e.position,i,r,t,s=!1,o;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(o=e.input.charCodeAt(e.position))!==0&&(O(e,!0,-1),o=e.input.charCodeAt(e.position),!(e.lineIndent>0||o!==37));){for(s=!0,o=e.input.charCodeAt(++e.position),i=e.position;o!==0&&!R(o);)o=e.input.charCodeAt(++e.position);for(r=e.input.slice(i,e.position),t=[],r.length<1&&C(e,"directive name must not be less than one character in length");o!==0;){for(;J(o);)o=e.input.charCodeAt(++e.position);if(o===35){do o=e.input.charCodeAt(++e.position);while(o!==0&&!K(o));break}if(K(o))break;for(i=e.position;o!==0&&!R(o);)o=e.input.charCodeAt(++e.position);t.push(e.input.slice(i,e.position))}o!==0&&Pe(e),Y.call(Ge,r)?Ge[r](e,r,t):he(e,'unknown document directive "'+r+'"')}if(O(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,O(e,!0,-1)):s&&C(e,"directives end mark is expected"),te(e,e.lineIndent-1,ge,!1,!0),O(e,!0,-1),e.checkLineBreaks&&gr.test(e.input.slice(n,e.position))&&he(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&ve(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,O(e,!0,-1));return}if(e.position<e.length-1)C(e,"end of the stream or a document separator is expected");else return}function yn(e,n){e=String(e),n=n||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var i=new xr(e,n),r=e.indexOf("\0");for(r!==-1&&(i.position=r,C(i,"null byte is not allowed in input")),i.input+="\0";i.input.charCodeAt(i.position)===32;)i.lineIndent+=1,i.position+=1;for(;i.position<i.length-1;)_r(i);return i.documents}function Dr(e,n,i){n!==null&&typeof n=="object"&&typeof i>"u"&&(i=n,n=null);var r=yn(e,i);if(typeof n!="function")return r;for(var t=0,s=r.length;t<s;t+=1)n(r[t])}function Pr(e,n){var i=yn(e,n);if(i.length!==0){if(i.length===1)return i[0];throw new P("expected a single document in the stream, but found more")}}var Rr=Dr,Lr=Pr,vn={loadAll:Rr,load:Lr},Cn=Object.prototype.toString,xn=Object.prototype.hasOwnProperty,Le=65279,Mr=9,ce=10,jr=13,Nr=32,$r=33,Ur=34,Fe=35,Kr=37,Wr=38,Br=39,Hr=42,bn=44,Yr=45,we=58,Vr=61,zr=62,Gr=63,qr=64,Sn=91,kn=93,Qr=96,An=123,Jr=124,In=125,D={};D[0]="\\0";D[7]="\\a";D[8]="\\b";D[9]="\\t";D[10]="\\n";D[11]="\\v";D[12]="\\f";D[13]="\\r";D[27]="\\e";D[34]='\\"';D[92]="\\\\";D[133]="\\N";D[160]="\\_";D[8232]="\\L";D[8233]="\\P";var Xr=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],Zr=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function et(e,n){var i,r,t,s,o,c,a;if(n===null)return{};for(i={},r=Object.keys(n),t=0,s=r.length;t<s;t+=1)o=r[t],c=String(n[o]),o.slice(0,2)==="!!"&&(o="tag:yaml.org,2002:"+o.slice(2)),a=e.compiledTypeMap.fallback[o],a&&xn.call(a.styleAliases,c)&&(c=a.styleAliases[c]),i[o]=c;return i}function nt(e){var n,i,r;if(n=e.toString(16).toUpperCase(),e<=255)i="x",r=2;else if(e<=65535)i="u",r=4;else if(e<=4294967295)i="U",r=8;else throw new P("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+i+F.repeat("0",r-n.length)+n}var it=1,ae=2;function rt(e){this.schema=e.schema||un,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=F.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=et(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?ae:it,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function Je(e,n){for(var i=F.repeat(" ",n),r=0,t=-1,s="",o,c=e.length;r<c;)t=e.indexOf(`
`,r),t===-1?(o=e.slice(r),r=c):(o=e.slice(r,t+1),r=t+1),o.length&&o!==`
`&&(s+=i),s+=o;return s}function Te(e,n){return`
`+F.repeat(" ",e.indent*n)}function tt(e,n){var i,r,t;for(i=0,r=e.implicitTypes.length;i<r;i+=1)if(t=e.implicitTypes[i],t.resolve(n))return!0;return!1}function ye(e){return e===Nr||e===Mr}function le(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==Le||65536<=e&&e<=1114111}function Xe(e){return le(e)&&e!==Le&&e!==jr&&e!==ce}function Ze(e,n,i){var r=Xe(e),t=r&&!ye(e);return(i?r:r&&e!==bn&&e!==Sn&&e!==kn&&e!==An&&e!==In)&&e!==Fe&&!(n===we&&!t)||Xe(n)&&!ye(n)&&e===Fe||n===we&&t}function ot(e){return le(e)&&e!==Le&&!ye(e)&&e!==Yr&&e!==Gr&&e!==we&&e!==bn&&e!==Sn&&e!==kn&&e!==An&&e!==In&&e!==Fe&&e!==Wr&&e!==Hr&&e!==$r&&e!==Jr&&e!==Vr&&e!==zr&&e!==Br&&e!==Ur&&e!==Kr&&e!==qr&&e!==Qr}function st(e){return!ye(e)&&e!==we}function oe(e,n){var i=e.charCodeAt(n),r;return i>=55296&&i<=56319&&n+1<e.length&&(r=e.charCodeAt(n+1),r>=56320&&r<=57343)?(i-55296)*1024+r-56320+65536:i}function On(e){var n=/^\n* /;return n.test(e)}var Fn=1,Ee=2,Tn=3,En=4,ne=5;function ct(e,n,i,r,t,s,o,c){var a,d=0,w=null,g=!1,y=!1,f=r!==-1,l=-1,u=ot(oe(e,0))&&st(oe(e,e.length-1));if(n||o)for(a=0;a<e.length;d>=65536?a+=2:a++){if(d=oe(e,a),!le(d))return ne;u=u&&Ze(d,w,c),w=d}else{for(a=0;a<e.length;d>=65536?a+=2:a++){if(d=oe(e,a),d===ce)g=!0,f&&(y=y||a-l-1>r&&e[l+1]!==" ",l=a);else if(!le(d))return ne;u=u&&Ze(d,w,c),w=d}y=y||f&&a-l-1>r&&e[l+1]!==" "}return!g&&!y?u&&!o&&!t(e)?Fn:s===ae?ne:Ee:i>9&&On(e)?ne:o?s===ae?ne:Ee:y?En:Tn}function at(e,n,i,r,t){e.dump=(function(){if(n.length===0)return e.quotingType===ae?'""':"''";if(!e.noCompatMode&&(Xr.indexOf(n)!==-1||Zr.test(n)))return e.quotingType===ae?'"'+n+'"':"'"+n+"'";var s=e.indent*Math.max(1,i),o=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-s),c=r||e.flowLevel>-1&&i>=e.flowLevel;function a(d){return tt(e,d)}switch(ct(n,c,e.indent,o,a,e.quotingType,e.forceQuotes&&!r,t)){case Fn:return n;case Ee:return"'"+n.replace(/'/g,"''")+"'";case Tn:return"|"+en(n,e.indent)+nn(Je(n,s));case En:return">"+en(n,e.indent)+nn(Je(lt(n,o),s));case ne:return'"'+ut(n)+'"';default:throw new P("impossible error: invalid scalar style")}})()}function en(e,n){var i=On(e)?String(n):"",r=e[e.length-1]===`
`,t=r&&(e[e.length-2]===`
`||e===`
`),s=t?"+":r?"":"-";return i+s+`
`}function nn(e){return e[e.length-1]===`
`?e.slice(0,-1):e}function lt(e,n){for(var i=/(\n+)([^\n]*)/g,r=(function(){var d=e.indexOf(`
`);return d=d!==-1?d:e.length,i.lastIndex=d,rn(e.slice(0,d),n)})(),t=e[0]===`
`||e[0]===" ",s,o;o=i.exec(e);){var c=o[1],a=o[2];s=a[0]===" ",r+=c+(!t&&!s&&a!==""?`
`:"")+rn(a,n),t=s}return r}function rn(e,n){if(e===""||e[0]===" ")return e;for(var i=/ [^ ]/g,r,t=0,s,o=0,c=0,a="";r=i.exec(e);)c=r.index,c-t>n&&(s=o>t?o:c,a+=`
`+e.slice(t,s),t=s+1),o=c;return a+=`
`,e.length-t>n&&o>t?a+=e.slice(t,o)+`
`+e.slice(o+1):a+=e.slice(t),a.slice(1)}function ut(e){for(var n="",i=0,r,t=0;t<e.length;i>=65536?t+=2:t++)i=oe(e,t),r=D[i],!r&&le(i)?(n+=e[t],i>=65536&&(n+=e[t+1])):n+=r||nt(i);return n}function ft(e,n,i){var r="",t=e.tag,s,o,c;for(s=0,o=i.length;s<o;s+=1)c=i[s],e.replacer&&(c=e.replacer.call(i,String(s),c)),(B(e,n,c,!1,!1)||typeof c>"u"&&B(e,n,null,!1,!1))&&(r!==""&&(r+=","+(e.condenseFlow?"":" ")),r+=e.dump);e.tag=t,e.dump="["+r+"]"}function tn(e,n,i,r){var t="",s=e.tag,o,c,a;for(o=0,c=i.length;o<c;o+=1)a=i[o],e.replacer&&(a=e.replacer.call(i,String(o),a)),(B(e,n+1,a,!0,!0,!1,!0)||typeof a>"u"&&B(e,n+1,null,!0,!0,!1,!0))&&((!r||t!=="")&&(t+=Te(e,n)),e.dump&&ce===e.dump.charCodeAt(0)?t+="-":t+="- ",t+=e.dump);e.tag=s,e.dump=t||"[]"}function dt(e,n,i){var r="",t=e.tag,s=Object.keys(i),o,c,a,d,w;for(o=0,c=s.length;o<c;o+=1)w="",r!==""&&(w+=", "),e.condenseFlow&&(w+='"'),a=s[o],d=i[a],e.replacer&&(d=e.replacer.call(i,a,d)),B(e,n,a,!1,!1)&&(e.dump.length>1024&&(w+="? "),w+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),B(e,n,d,!1,!1)&&(w+=e.dump,r+=w));e.tag=t,e.dump="{"+r+"}"}function pt(e,n,i,r){var t="",s=e.tag,o=Object.keys(i),c,a,d,w,g,y;if(e.sortKeys===!0)o.sort();else if(typeof e.sortKeys=="function")o.sort(e.sortKeys);else if(e.sortKeys)throw new P("sortKeys must be a boolean or a function");for(c=0,a=o.length;c<a;c+=1)y="",(!r||t!=="")&&(y+=Te(e,n)),d=o[c],w=i[d],e.replacer&&(w=e.replacer.call(i,d,w)),B(e,n+1,d,!0,!0,!0)&&(g=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,g&&(e.dump&&ce===e.dump.charCodeAt(0)?y+="?":y+="? "),y+=e.dump,g&&(y+=Te(e,n)),B(e,n+1,w,!0,g)&&(e.dump&&ce===e.dump.charCodeAt(0)?y+=":":y+=": ",y+=e.dump,t+=y));e.tag=s,e.dump=t||"{}"}function on(e,n,i){var r,t,s,o,c,a;for(t=i?e.explicitTypes:e.implicitTypes,s=0,o=t.length;s<o;s+=1)if(c=t[s],(c.instanceOf||c.predicate)&&(!c.instanceOf||typeof n=="object"&&n instanceof c.instanceOf)&&(!c.predicate||c.predicate(n))){if(i?c.multi&&c.representName?e.tag=c.representName(n):e.tag=c.tag:e.tag="?",c.represent){if(a=e.styleMap[c.tag]||c.defaultStyle,Cn.call(c.represent)==="[object Function]")r=c.represent(n,a);else if(xn.call(c.represent,a))r=c.represent[a](n,a);else throw new P("!<"+c.tag+'> tag resolver accepts not "'+a+'" style');e.dump=r}return!0}return!1}function B(e,n,i,r,t,s,o){e.tag=null,e.dump=i,on(e,i,!1)||on(e,i,!0);var c=Cn.call(e.dump),a=r,d;r&&(r=e.flowLevel<0||e.flowLevel>n);var w=c==="[object Object]"||c==="[object Array]",g,y;if(w&&(g=e.duplicates.indexOf(i),y=g!==-1),(e.tag!==null&&e.tag!=="?"||y||e.indent!==2&&n>0)&&(t=!1),y&&e.usedDuplicates[g])e.dump="*ref_"+g;else{if(w&&y&&!e.usedDuplicates[g]&&(e.usedDuplicates[g]=!0),c==="[object Object]")r&&Object.keys(e.dump).length!==0?(pt(e,n,e.dump,t),y&&(e.dump="&ref_"+g+e.dump)):(dt(e,n,e.dump),y&&(e.dump="&ref_"+g+" "+e.dump));else if(c==="[object Array]")r&&e.dump.length!==0?(e.noArrayIndent&&!o&&n>0?tn(e,n-1,e.dump,t):tn(e,n,e.dump,t),y&&(e.dump="&ref_"+g+e.dump)):(ft(e,n,e.dump),y&&(e.dump="&ref_"+g+" "+e.dump));else if(c==="[object String]")e.tag!=="?"&&at(e,e.dump,n,s,a);else{if(c==="[object Undefined]")return!1;if(e.skipInvalid)return!1;throw new P("unacceptable kind of an object to dump "+c)}e.tag!==null&&e.tag!=="?"&&(d=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?d="!"+d:d.slice(0,18)==="tag:yaml.org,2002:"?d="!!"+d.slice(18):d="!<"+d+">",e.dump=d+" "+e.dump)}return!0}function mt(e,n){var i=[],r=[],t,s;for(_e(e,i,r),t=0,s=r.length;t<s;t+=1)n.duplicates.push(i[r[t]]);n.usedDuplicates=new Array(s)}function _e(e,n,i){var r,t,s;if(e!==null&&typeof e=="object")if(t=n.indexOf(e),t!==-1)i.indexOf(t)===-1&&i.push(t);else if(n.push(e),Array.isArray(e))for(t=0,s=e.length;t<s;t+=1)_e(e[t],n,i);else for(r=Object.keys(e),t=0,s=r.length;t<s;t+=1)_e(e[r[t]],n,i)}function gt(e,n){n=n||{};var i=new rt(n);i.noRefs||mt(e,i);var r=e;return i.replacer&&(r=i.replacer.call({"":r},"",r)),B(i,0,r,!0,!0)?i.dump+`
`:""}var ht=gt,wt={dump:ht};function Me(e,n){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+n+" instead, which is now safe by default.")}}var Ce=vn.load,Tt=vn.loadAll,Et=wt.dump;var _t=Me("safeLoad","load"),Dt=Me("safeLoadAll","loadAll"),Pt=Me("safeDump","dump");var Mn=Se(require("os")),jn=Se(require("path")),yt=(0,Ln.promisify)(Rn.execFile),z=class e extends p.TreeItem{constructor(i,r){super(i.label,i.collapsibleState??(i.children&&i.children.length>0?p.TreeItemCollapsibleState.Collapsed:p.TreeItemCollapsibleState.None));this.extensionUri=r;this.description=i.description,this.tooltip=i.tooltip,this.contextValue=i.contextValue??i.itemKind,this.iconPath=i.iconPath,this.workspaceFolder=i.workspaceFolder,this.data=i.data,this.itemKind=i.itemKind,this.children=(i.children??[]).map(t=>new e(t,this.extensionUri)),i.command&&(this.command={command:i.command.id,title:i.command.title??U(i.label),arguments:[this]})}children;workspaceFolder;data;itemKind},Z=class{constructor(n,i,r){this.kind=n;this.service=i;this.extensionUri=r}_onDidChangeTreeData=new p.EventEmitter;onDidChangeTreeData=this._onDidChangeTreeData.event;refresh(){this._onDidChangeTreeData.fire(void 0)}getTreeItem(n){return n}async getChildren(n){if(n)return n.children;let i=await this.service.getProjectFolders();if(i.length===0)return[new z({label:"No CumulusCI project found in workspace",description:"Open a folder containing cumulusci.yml",contextValue:"cumulusci.message",itemKind:"message"},this.extensionUri)];try{let r=[];for(let t of i){let s=await this.loadItemsForFolder(t);if(i.length===1){r.push(...s);continue}r.push({label:t.name,collapsibleState:p.TreeItemCollapsibleState.Expanded,contextValue:"cumulusci.folder",itemKind:"folder",children:s,workspaceFolder:t})}return r.length===0?[new z({label:this.emptyStateLabel(),contextValue:"cumulusci.message",itemKind:"message"},this.extensionUri)]:r.map(t=>new z(t,this.extensionUri))}catch(r){let t=r instanceof Error?r.message:String(r);return[new z({label:`Failed to load ${this.kind}`,description:t,tooltip:t,contextValue:"cumulusci.error",itemKind:"error"},this.extensionUri)]}}emptyStateLabel(){return this.kind==="orgs"?"No orgs found in CCI project":this.kind==="tasks"?"No tasks defined in CCI project":this.kind==="flows"?"No flows defined in CCI project":"Project info unavailable"}loadItemsForFolder(n){return this.kind==="orgs"?this.service.listOrgs(n):this.kind==="tasks"?this.service.listTasks(n):this.kind==="flows"?this.service.listFlows(n):this.kind==="services"?this.service.listServices(n):this.service.listProjectInfo(n)}},Ue=class{constructor(n,i){this.extensionUri=n;this.output=i;this.icons={scratchActive:this.icon("media","images","green-circle-small.svg"),scratchInactive:this.icon("media","images","green-circle-dashed.svg"),connected:this.icon("media","images","connected-blue.svg"),orgDefault:this.icon("media","images","grey-ring.svg"),flow:{light:this.icon("resources","light","flow.svg"),dark:this.icon("resources","dark","flow.svg")},refresh:{light:this.icon("resources","light","refresh.svg"),dark:this.icon("resources","dark","refresh.svg")},run:{light:this.icon("resources","light","run.svg"),dark:this.icon("resources","dark","run.svg")}}}configCandidates=["cumulusci.yml","cumulusci.yaml"];orgLabelKeys=["alias","name","org_name","config_name","key"];orgDescriptionKeys=["username","instance_url","status"];taskLabelKeys=["name","task_name"];taskDescriptionKeys=["description","group"];flowLabelKeys=["name","flow"];flowDescriptionKeys=["description","group"];groupKeys=["group","category","type"];icons;async getProjectFolders(){let n=p.workspace.workspaceFolders??[],i=[];for(let r of n)await this.hasCciConfig(r)&&i.push(r);return i}async listOrgs(n){return(await this.getOrgEntries(n)).map(r=>this.orgEntryToTreeItem(n,r))}async findDefaultOrg(){let n=await this.getProjectFolders();for(let i of n){let t=(await this.getOrgEntries(i)).find(s=>A(s.data,["is_default","default","isDefault"])===!0);if(t)return{folder:i,entry:t}}}async listTasks(n){let{records:i}=await this.fetchRecords(n,["task","list"],"tasks");return i=await this.includeConfigDefinitions(i,n,"tasks"),this.buildGroupedItems(n,i,{labelKeys:this.taskLabelKeys,descriptionKeys:this.taskDescriptionKeys,itemKind:"task",contextValue:"cumulusci.task",command:{id:"cumulusci.runTask",title:"Run Task"},iconPath:new p.ThemeIcon("tools")})}async listFlows(n){let{records:i}=await this.fetchRecords(n,["flow","list"],"flows");return i=await this.includeConfigDefinitions(i,n,"flows"),this.buildGroupedItems(n,i,{labelKeys:this.flowLabelKeys,descriptionKeys:this.flowDescriptionKeys,itemKind:"flow",contextValue:"cumulusci.flow",command:{id:"cumulusci.runFlow",title:"Run Flow"},iconPath:this.icons.flow})}async listServices(n){let i=await this.getServiceTypeGroups(n);return i.length===0?[{label:"No services reported by CCI",description:"Run cci service connect to add one",contextValue:"cumulusci.message",itemKind:"message"}]:i.map(r=>{let t=r.description?r.description:void 0,s=[];for(let o of r.entries)s.push({label:o.name,description:o.isDefault?"Default":void 0,tooltip:o.description,contextValue:o.isDefault?"cumulusci.service.default":"cumulusci.service",itemKind:"service",iconPath:o.isDefault?new p.ThemeIcon("star-full"):new p.ThemeIcon("key"),data:{type:r.type,typeLabel:r.label,name:o.name,description:o.description,isDefault:o.isDefault,attributes:r.attributes},workspaceFolder:n,command:{id:"cumulusci.service.showInfo",title:"Show Service Info"}});return s.length===0&&s.push({label:"No service connected",description:'Run "cci service connect" to configure',contextValue:"cumulusci.message",itemKind:"message",workspaceFolder:n}),{label:r.label,description:s.some(o=>o.itemKind==="service")?void 0:"Not configured",tooltip:t,contextValue:"cumulusci.serviceType",itemKind:"serviceType",iconPath:new p.ThemeIcon("plug"),children:s,workspaceFolder:n,data:{type:r.type,label:r.label,description:r.description,attributes:r.attributes}}})}async getServiceTypeGroups(n){let i=await this.runCciCommand(n,["service","list","--plain"]),r=this.parseServiceListOutput(i);if(r.length===0)return[];let t=await this.fetchServiceTypeMetadata(n);return this.groupServiceRows(r,t)}async listProjectInfo(n){let i=await this.runCciCommand(n,["project","info"]),r=this.parseProjectInfoOutput(i),t=this.stripAnsiSequences(i).trim();if(!r)return t?[{label:"Unable to parse project info output",description:"See tooltip for raw content",tooltip:t,itemKind:"error",contextValue:"cumulusci.error"}]:[];let s=this.buildProjectInfoItems(r);return s.length===0?[]:s}async getOrgQuickPickItems(n){return(await this.getOrgEntries(n)).filter(r=>!r.definitionMissing).map(r=>({label:r.alias,description:r.description,detail:this.describeOrgEntry(r),alias:r.alias,data:r.data,orgCreated:r.orgCreated,expired:r.expired,isScratch:r.isScratch,definitionOnly:r.definitionOnly,definitionMissing:r.definitionMissing})).sort((r,t)=>r.label.localeCompare(t.label))}async runCciCommand(n,i){let r=["cci",...i.map(be)].join(" "),t=this.describeWorkspace(n);this.output.appendLine(`${t}$ ${r}`);let s=Date.now();try{let{stdout:o}=await yt("cci",i,{cwd:n.uri.fsPath,env:{...process.env,CUMULUSCI_DISABLE_GIST_LOGGER:"1"}});return this.logCommandResult(t,o,Date.now()-s),o}catch(o){if(o.code==="ENOENT"){let d=`CumulusCI CLI (cci) not found. To use this extension, first install the CumulusCI CLI.

Install CumulusCI CLI by following the instructions at https://cumulusci.readthedocs.io/en/latest/install.html and ensure that the "cci" command is available in your system PATH.`;throw this.output.appendLine(`${t}! ${d}`),new Error(d)}let c=o.stderr??o.message,a=this.stripAnsiSequences(c??"").trim();throw a.length>0&&this.output.appendLine(`${t}! ${a}`),new Error(a||"Unknown CCI CLI error")}}async getOrgInfo(n,i){let r=await this.runCciCommand(n,["org","info",i,"--json"]),t=this.parseJsonObject(r);if(!t)throw new Error("Failed to parse CCI org info output as JSON.");return t}async getServiceInfo(n,i,r){let t=["service","info"];t.push(i),r&&r.trim().length>0&&t.push(r.trim());let s=await this.runCciCommand(n,t);return this.parseServiceInfoOutput(s)}parseServiceListOutput(n){let i=this.stripAnsiSequences(n);if(!i.trim())return[];let t=i.split(/\r?\n/),s=t.findIndex(u=>u.includes("Default")&&u.includes("Type")&&u.includes("Name")&&u.includes("Description"));if(s===-1)return[];let o=t[s],c=o.indexOf("Default"),a=o.indexOf("Type",Math.max(c,0)),d=o.indexOf("Name",Math.max(a,0)),w=o.indexOf("Description",Math.max(d,0));if(a<0||d<0||w<0)return[];let g=t.findIndex((u,m)=>m>s&&/[\u2500\-]{3,}/.test(u.replace(/\s+/g,""))),y=g>=0?g+1:s+1,f=[],l;for(let u=y;u<t.length;u+=1){let m=t[u];if(!m)continue;let h=m.trim();if(!h||/^[\u2500\-]{3,}$/.test(h.replace(/\s+/g,"")))continue;let v=m.slice(0,a).trim(),x=m.slice(a,d).trim(),S=m.slice(d,w).trim(),k=w<m.length?m.slice(w).trim():"";if(!v&&!x&&!S&&k.length>0&&l){l.description=this.appendWrappedText(l.description,k);continue}if(!x&&!S&&!v)continue;let E={type:x,name:S||void 0,isDefault:v.includes("\u2714"),description:k};f.push(E),l=E}return f.map(u=>({...u,type:u.type.trim(),description:this.normalizeServiceDescription(u.description)}))}async fetchServiceTypeMetadata(n){try{let i=await this.runCciCommand(n,["service","list","--json"]),r=this.parseJsonObject(i);if(!r)return new Map;let t=new Map;for(let[s,o]of Object.entries(r)){let c=V(o);if(!c)continue;let a=V(c.attributes),d=[];if(a){for(let[g,y]of Object.entries(a)){let f=V(y);if(!f)continue;let l=b(f,["description"]),u=A(f,["required"])??!1,m=A(f,["sensitive"])??!1,h=b(f,["default"]),v=b(f,["default_factory"]);d.push({name:g,description:l,required:u,sensitive:m,defaultValue:h,defaultFactory:v})}d.sort((g,y)=>g.name.localeCompare(y.name))}let w=b(c,["description"])??"";t.set(s,{description:w,attributes:d})}return t}catch(i){return this.didFailDueToJsonFlag(i)?new Map:new Map}}groupServiceRows(n,i){let r=new Map;for(let s of n){let o=s.type.trim();if(!o)continue;let c=r.get(o);c||(c={description:"",entries:[]},r.set(o,c));let a=this.normalizeServiceDescription(s.description);a&&c.description.length===0&&(c.description=a),s.name&&c.entries.push({name:s.name,description:a,isDefault:s.isDefault})}let t=[];for(let[s,o]of r.entries()){let c=o.entries.slice().sort((w,g)=>w.isDefault!==g.isDefault?w.isDefault?-1:1:w.name.localeCompare(g.name)),a=i.get(s),d=o.description||a?.description||"";t.push({type:s,label:xe(s),description:d,entries:c,attributes:a?.attributes??[]})}return t.sort((s,o)=>s.label.localeCompare(o.label)),t}parseServiceInfoOutput(n){let r=this.stripAnsiSequences(n).split(/\r?\n/),t={entries:[]},s=r.findIndex(f=>f.includes("Key")&&f.includes("Value"));if(s===-1){let f=r.map(l=>l.trim()).find(l=>l.length>0);return f&&(t.title=this.normalizeServiceDescription(f)),t}for(let f=0;f<s;f+=1){let l=r[f]?.trim();l&&!/^[\u2500\-]{3,}$/.test(l.replace(/\s+/g,""))&&(t.title=this.normalizeServiceDescription(l))}let o=r[s],c=o.indexOf("Key"),a=o.indexOf("Value",Math.max(c,0));if(c<0||a<0)return t;let d=r.findIndex((f,l)=>l>s&&/[\u2500\-]{3,}/.test(f.replace(/\s+/g,""))),w=d>=0?d+1:s+1,g,y=[];for(let f=w;f<r.length;f+=1){let l=r[f];if(!l)continue;let u=l.trim();if(!u||/^[\u2500\-]{3,}$/.test(u.replace(/\s+/g,"")))continue;let m=l.slice(c,a).trim(),h=a<l.length?l.slice(a).trim():"";if(m){g={key:m,value:this.normalizeServiceDescription(h)},y.push(g);continue}g&&h&&(g.value=this.appendWrappedText(g.value,h))}return t.entries=y.map(f=>({key:f.key,value:this.normalizeServiceDescription(f.value)})),t}appendWrappedText(n,i){let r=this.normalizeServiceDescription(n),t=this.normalizeServiceDescription(i);return r?t?`${r} ${t}`.trim():r:t}normalizeServiceDescription(n){return n?n.replace(/\s+/g," ").trim():""}parseProjectInfoOutput(n){let r=this.stripAnsiSequences(n).trim();if(!r)return;let t=new Set;t.add(r);let s=r.split(/\r?\n/),o=s.findIndex(a=>a.trim().toLowerCase().startsWith("name:"));if(o>0){let a=s.slice(o).join(`
`).trim();a.length>0&&t.add(a)}let c=s.findIndex(a=>/^[A-Za-z0-9_-]+\s*:\s*/.test(a.trim()));if(c>0){let a=s.slice(c).join(`
`).trim();a.length>0&&t.add(a)}for(let a of t){let d=this.tryParseProjectInfo(a);if(d)return d;let w=this.normalizeProjectInfoYaml(a);if(w!==a){let g=this.tryParseProjectInfo(w);if(g)return g}}}buildProjectInfoItems(n){let i=Object.entries(n);return i.sort((r,t)=>r[0]==="name"?-1:t[0]==="name"?1:r[0].localeCompare(t[0])),i.map(([r,t])=>this.buildProjectInfoItem(r,t))}buildProjectInfoItem(n,i,r={}){let t=r.parentIsArray?"cumulusci.project.arrayItem":"cumulusci.project.field";if(this.isPlainObject(i)){let s=Object.entries(i);if(s.length===0)return this.buildProjectLeafItem(n,"(empty object)",t,i);s.sort((c,a)=>c[0].localeCompare(a[0]));let o=s.map(([c,a])=>this.buildProjectInfoItem(c,a));return{label:n,itemKind:"group",contextValue:`${t}.group`,collapsibleState:p.TreeItemCollapsibleState.Collapsed,iconPath:new p.ThemeIcon("symbol-structure"),children:o,data:{key:n,value:i}}}if(Array.isArray(i)){if(i.length===0)return this.buildProjectLeafItem(n,"(empty list)",t,i);let s=i.map((o,c)=>this.buildProjectInfoItem(`Item ${c+1}`,o,{parentIsArray:!0}));return{label:n,description:`${i.length} item${i.length===1?"":"s"}`,itemKind:"group",contextValue:`${t}.array`,collapsibleState:p.TreeItemCollapsibleState.Collapsed,iconPath:new p.ThemeIcon("list-unordered"),children:s,data:{key:n,value:i}}}return this.buildProjectLeafItem(n,i,t,i)}buildProjectLeafItem(n,i,r,t){let{display:s,tooltip:o}=this.formatProjectScalarValue(i),c=`${n}: ${s}`;return{label:c,tooltip:o?`${n}: ${o}`:c,itemKind:"message",contextValue:`${r}.leaf`,iconPath:new p.ThemeIcon("symbol-string"),data:{key:n,value:t}}}tryParseProjectInfo(n){try{let i=Ce(n);if(i&&typeof i=="object"&&!Array.isArray(i))return i}catch{}}normalizeProjectInfoYaml(n){return n.split(/\r?\n/).map(t=>{let s=t.match(/^(\s*[^:#\n]+?):\s*(.*)$/);if(!s)return t;let[,o,c]=s;if(c.length===0)return t;let a=c.trim();if(a.length===0)return`${o}: ''`;if(/^[>|-]/.test(a)||/^["']/.test(a)||a.endsWith(":")&&!a.includes(" ")||/^\d+\s*:$/.test(a)||!(/[:#%]/.test(a)||/^https?:/i.test(a)))return t;let w=a.replace(/\\/g,"\\\\").replace(/"/g,'\\"');return`${o}: "${w}"`}).join(`
`)}formatProjectScalarValue(n){if(n===null)return{display:"null",tooltip:"null"};if(n===void 0)return{display:"\u2013",tooltip:"No value set"};if(typeof n=="string"){let i=n.trim();return i.length===0?{display:"\u2013",tooltip:"Empty string"}:{display:i.replace(/\r?\n/g," \u23CE "),tooltip:i}}if(typeof n=="number"||typeof n=="boolean"){let i=String(n);return{display:i,tooltip:i}}return{display:JSON.stringify(n),tooltip:JSON.stringify(n,null,2)}}stripAnsiSequences(n){return n.replace(/\u001b\[[0-9;?]*[A-Za-z]/g,"")}describeWorkspace(n){return`[${n.name||n.uri.fsPath}]`}logCommandResult(n,i,r){let t=this.stripAnsiSequences(i).trim();if(t.length>0){let o=t.split(/\r?\n/),c=20;for(let a of o.slice(0,c))this.output.appendLine(`${n}> ${a}`);o.length>c&&this.output.appendLine(`${n}> \u2026 (${o.length-c} more lines)`)}let s=Math.max(r/1e3,0).toFixed(1);this.output.appendLine(`${n}\u2713 Completed in ${s}s`)}isPlainObject(n){return!!n&&typeof n=="object"&&!Array.isArray(n)}async findCciConfigUri(n){for(let i of this.configCandidates){let r=p.Uri.joinPath(n.uri,...i.split("/"));try{return await(0,Ne.access)(r.fsPath,$e.constants.R_OK),r}catch{}}}async getOrgDefinitions(n){let i=new Map;for(let r of await this.collectOrgsDirectoryDefinitions(n))this.mergeOrgDefinition(i,r);for(let r of await this.collectConfigScratchDefinitions(n))this.mergeOrgDefinition(i,r);return i}mergeOrgDefinition(n,i){let r=je(i.alias),t=n.get(r);if(t){!t.configPath&&i.configPath&&(t.configPath=i.configPath),t.isScratch=t.isScratch??i.isScratch,i.sources.forEach(s=>t.sources.add(s));return}n.set(r,{alias:X(i.alias),configPath:i.configPath,isScratch:i.isScratch,sources:new Set(i.sources)})}async collectOrgsDirectoryDefinitions(n){let i=[],r=p.Uri.joinPath(n.uri,"orgs");try{let t=await p.workspace.fs.readDirectory(r);for(let[s,o]of t){if(o!==p.FileType.File)continue;let c=s.match(/^(.*)\.(ya?ml|json)$/i);if(!c)continue;let a=X(c[1]);if(!a)continue;let d=`orgs/${s}`;i.push({alias:a,configPath:d,isScratch:!0,sources:new Set([d])})}}catch{}return i}async collectConfigScratchDefinitions(n){let i=[],r=await this.findCciConfigUri(n);if(!r)return i;try{let t=await p.workspace.fs.readFile(r),s=Buffer.from(t).toString("utf8"),o=Ce(s);if(!o||typeof o!="object")return i;let c=o.orgs;if(!c||typeof c!="object")return i;let a=c.scratch;if(!a)return i;let d=r.path.split("/").pop()??"cumulusci.yml",w=p.workspace.asRelativePath(r,!1)||d,g=(y,f)=>{let l=X(y);if(!l)return;let u=new Set([w]),m;if(typeof f=="string")m=f;else if(f&&typeof f=="object"){let v=f.config_file;typeof v=="string"&&v.trim().length>0&&(m=v.trim())}m&&u.add(m),i.push({alias:l,configPath:m,isScratch:!0,sources:u})};if(Array.isArray(a)){for(let y of a)if(typeof y=="string")g(y,void 0);else if(y&&typeof y=="object")for(let[f,l]of Object.entries(y))g(f,l)}else if(typeof a=="object")for(let[y,f]of Object.entries(a))g(y,f)}catch{}return i}icon(...n){return p.Uri.joinPath(this.extensionUri,...n)}async hasCciConfig(n){return await this.findCciConfigUri(n)!==void 0}async fetchRecords(n,i,r){try{let s=await this.runCciCommand(n,[...i,"--json"]),o=this.parseJsonRecords(s,r);if(o.length>0)return{records:o,format:"json"}}catch(s){if(!this.didFailDueToJsonFlag(s))throw s}let t=await this.runCciCommand(n,i);return{records:this.parseTextRecords(t),format:"text"}}async includeConfigDefinitions(n,i,r){let t=r==="tasks"?this.taskLabelKeys:this.flowLabelKeys,s=await this.loadConfigDefinitionsMap(i,r),o=[];for(let c of n){let a=this.normalizeRecord(c,t),d=a?b(a,t):void 0;if(d){let w=d.toLowerCase(),g=s.get(w);g&&a&&(this.mergeConfigDefinition(a,g),s.delete(w))}a&&o.push(a)}for(let c of s.values())o.push({...c});return o}async loadProjectConfigSection(n,i){let r=await this.findCciConfigUri(n);return r?this.loadConfigSectionFromSource(r,i,"project"):[]}async loadGlobalConfigSection(n){let i=jn.join(Mn.homedir(),".cumulusci","cumulusci.yml");try{await(0,Ne.access)(i,$e.constants.R_OK)}catch{return[]}let r=p.Uri.file(i);return this.loadConfigSectionFromSource(r,n,"global")}async loadConfigSectionFromSource(n,i,r){try{let t=await p.workspace.fs.readFile(n),s=Buffer.from(t).toString("utf8"),o=Ce(s);if(!o||typeof o!="object"||Array.isArray(o))return[];let c=o[i];return this.convertConfigSectionToRecords(c,r)}catch{return[]}}convertConfigSectionToRecords(n,i){if(!n||typeof n!="object"||Array.isArray(n))return[];let r=[];for(let[t,s]of Object.entries(n)){let o={name:t,configSource:i};if(typeof s=="string")o.description=s;else if(s&&typeof s=="object"){let c=s;typeof c.description=="string"&&(o.description=c.description),typeof c.group=="string"&&(o.group=c.group),o.configDefinition=c}o.group===void 0&&(o.group=i==="global"?"Workspace Config":"Project Config"),r.push(o)}return r}async loadConfigDefinitionsMap(n,i){let r=[...await this.loadProjectConfigSection(n,i),...await this.loadGlobalConfigSection(i)],t=new Map;for(let s of r){let o=typeof s.name=="string"?s.name.trim():void 0;o&&t.set(o.toLowerCase(),s)}return t}normalizeRecord(n,i){let r=V(n);if(r)return{...r};if(typeof n=="string"){let t=n.trim();return t.length===0?void 0:{name:t}}}mergeConfigDefinition(n,i){n.configSource=i.configSource??n.configSource,i.configDefinition&&(n.configDefinition=i.configDefinition),i.group&&(!n.group||n.group==="Ungrouped")&&(n.group=i.group),i.description&&!n.description&&(n.description=i.description)}extractNameFromRecord(n,i){let r=V(n);if(r){let t=b(r,i);if(t)return t}if(typeof n=="string"){let t=n.trim();if(t.length>0)return t}}parseJsonRecords(n,i){let r=n.trim();if(!r)return[];let t=[r],s=r.indexOf("{"),o=r.indexOf("["),c=[s,o].filter(a=>a>=0).sort((a,d)=>a-d);for(let a of c){let d=r.slice(a).trim();d.length>0&&t.push(d)}for(let a of t)try{let d=JSON.parse(a);return this.normalizeJsonRecords(d,i)}catch{}return[]}parseJsonObject(n){let i=n.trim();if(!i)return;let r=[i],t=i.indexOf("{");t>0&&r.push(i.slice(t).trim());for(let s of r)try{let o=JSON.parse(s),c=V(o);if(c)return c}catch{}}parseTextRecords(n){return n.split(/\r?\n/).map(i=>i.trim()).filter(i=>i.length>0&&!/^[-=]+$/.test(i)&&!/^Name\s+/i.test(i))}normalizeJsonRecords(n,i){if(Array.isArray(n))return n;if(n&&typeof n=="object"){let r=n,t=r[i];if(Array.isArray(t))return t;if(t&&typeof t=="object"&&!Array.isArray(t))return this.mapEntriesToRecords(t);for(let s of Object.values(r))if(Array.isArray(s))return s;return this.isAliasRecordMap(r)?this.mapEntriesToRecords(r):[r]}return[]}isAliasRecordMap(n){let i=Object.values(n);return i.length===0?!1:i.every(r=>r&&typeof r=="object"&&!Array.isArray(r))}mapEntriesToRecords(n){return Object.entries(n).map(([i,r])=>{if(r&&typeof r=="object"&&!Array.isArray(r)){let t={...r},s=typeof t.alias=="string"?t.alias.trim():"",o=s.length>0?s:i;t.alias=o,(typeof t.name!="string"||t.name.trim().length===0)&&(t.name=o);let c=typeof t.config=="string"&&t.config.trim().length>0?t.config.trim():void 0;return t.config_name===void 0&&(t.config_name=c??o),t.key===void 0&&(t.key=o),t.orgCreated===void 0&&typeof t.expired=="boolean"&&(t.orgCreated=!t.expired),t}return{alias:i,value:r}})}didFailDueToJsonFlag(n){let i=n instanceof Error?n.message:String(n);return/--json/i.test(i)||/no such option/i.test(i)}async getOrgEntries(n){let{records:i}=await this.fetchRecords(n,["org","list"],"orgs"),r=await this.getOrgDefinitions(n),t=new Map;for(let o of i){let c=V(o),a;if(c)a={...c};else if(typeof o=="string"&&o.trim().length>0){let l=X(o.trim());if(l.length===0)continue;a={alias:l,name:l}}if(!a)continue;let d=b(a,this.orgLabelKeys);if(!d&&typeof a.alias=="string"&&(d=a.alias),!d&&typeof a.name=="string"&&(d=a.name),!d)continue;let w=X(d);a.alias=w,(typeof a.name!="string"||a.name.trim().length===0)&&(a.name=w),a.config_name===void 0&&(a.config_name=typeof a.config=="string"?a.config:w);let g=je(w),y=r.get(g),f=new Set(_n(a.definitionSources));y?(!a.config&&y.configPath&&(a.config=y.configPath),y.isScratch!==void 0&&(a.is_scratch=y.isScratch),y.sources.forEach(l=>f.add(l)),r.delete(g)):a.is_scratch===!0&&(a.definitionMissing=!0),a.definitionOnly=!1,f.size>0?a.definitionSources=Array.from(f):delete a.definitionSources,t.set(g,a)}for(let o of r.values()){let c=X(o.alias);if(!c)continue;let a=je(c);if(t.has(a))continue;let d=Array.from(o.sources),w={alias:c,name:c,config:o.configPath,config_name:o.configPath??c,is_scratch:o.isScratch??!0,orgCreated:!1,expired:!1,definitionOnly:!0};d.length>0&&(w.definitionSources=d),t.set(a,w)}let s=[];for(let o of t.values()){let c=this.createOrgEntry(o);c&&s.push(c)}return s.sort((o,c)=>o.alias.localeCompare(c.alias)),s}createOrgEntry(n){let i={...n},r=b(i,this.orgLabelKeys)??b(i,Object.keys(i));if(!r)return;i.alias=r,(typeof i.name!="string"||i.name.trim().length===0)&&(i.name=r);let t=b(i,["config","config_name"]);i.config_name===void 0&&(i.config_name=t??r);let s=A(i,["is_default","default","isDefault"])??!1,o=A(i,["scratch","scratch_org","is_scratch","isScratch"])??!1,c=A(i,["expired"])??!1,a=A(i,["orgCreated","active","is_active"]),d=b(i,["days"]),w=b(i,["domain","instance_url","login_url"]),g=_n(i.definitionSources),y=typeof i.definitionOnly=="boolean"?i.definitionOnly:!1,f=A(i,["definitionMissing"])??!1,l=typeof w=="string"&&w.length>0,u;f||y?u=!1:o?u=a??(l&&!c):u=a??l,l||(u=!1),i.orgCreated=u,i.expired=c,i.definitionOnly=y,g.length>0&&(i.definitionSources=g),f&&(i.definitionMissing=!0);let m=this.buildOrgDescription({isScratch:o,expired:c,isDefault:s,dayCount:d,orgCreated:u,definitionOnly:y,definitionMissing:f}),h=this.createOrgTooltip({alias:r,configName:t,isDefault:s,isScratch:o,expired:c,dayCount:d,domain:w,data:i,orgCreated:u,definitionSources:g,definitionOnly:y,definitionMissing:f}),v=f?"cumulusci.org.disabled":"cumulusci.org",x=f?void 0:{id:"cumulusci.org.showActions",title:"Org Actions"};return{alias:r,data:i,description:m,tooltip:h,contextValue:v,iconPath:this.getOrgIcon(i),command:x,isScratch:o,orgCreated:u,expired:c,definitionOnly:y,definitionMissing:f}}orgEntryToTreeItem(n,i){return{label:i.alias,description:i.description,tooltip:i.tooltip,contextValue:i.contextValue,itemKind:"org",workspaceFolder:n,data:i.data,iconPath:i.iconPath,command:i.command}}describeOrgEntry(n){let i=[];i.push(n.isScratch?"Scratch org":"Connected org"),n.definitionMissing?i.push("Missing definition"):n.definitionOnly?i.push("Definition only (will create on run)"):n.isScratch?(i.push(n.orgCreated?"Active":"Not created"),n.expired&&i.push("Expired")):i.push(n.orgCreated?"Ready":"Unavailable");let r=b(n.data,["instance_url","domain","login_url"]);return r&&i.push(r),i.join(" \u2022 ")}buildOrgDescription(n){let i=[];if(n.isScratch){if(n.definitionMissing?i.push("Scratch definition missing"):n.definitionOnly?i.push("Scratch (definition)"):n.orgCreated?i.push(n.expired?"Scratch (expired)":"Scratch"):i.push(n.expired?"Scratch (expired)":"Scratch (not created)"),n.orgCreated&&!n.expired){let r=this.formatScratchDayDisplay(n.dayCount);r&&i.push(r)}}else i.push(n.orgCreated?"Connected":"Connected (not linked)");return n.isDefault&&i.push("Default"),i.length>0?i.join(" \u2022 "):void 0}createOrgTooltip(n){let i=new p.MarkdownString;i.isTrusted=!1,i.appendMarkdown(`**${n.alias}**

`);let r=[`- Config: ${n.configName??"n/a"}`,`- Default org: ${n.isDefault?"Yes":"No"}`,`- Type: ${n.isScratch?"Scratch org":"Connected org"}`,`- Created: ${n.orgCreated?"Yes":"No"}`];if(n.isScratch){if(n.definitionMissing)r.push("- Scratch status: Definition missing");else if(n.definitionOnly)r.push("- Scratch status: Definition only");else if(r.push(`- Scratch status: ${n.expired?"Expired":n.orgCreated?"Active":"Not created"}`),n.orgCreated&&!n.expired){let t=this.formatScratchDayDisplay(n.dayCount);t&&r.push(`- ${t}`)}}return n.domain&&n.domain.trim().length>0&&r.push(`- Domain: ${n.domain}`),n.definitionMissing&&r.push("- Definition status: Missing local definition file"),n.definitionSources.length>0&&r.push(`- Defined in: ${n.definitionSources.join(", ")}`),i.appendMarkdown(r.join(`
`)),i.appendMarkdown(`
`),i.appendCodeblock(JSON.stringify(n.data,null,2),"json"),i}formatScratchDayDisplay(n){if(!n)return;let i=n.trim();if(!i)return;let{remaining:r,total:t}=Nn(i);return $n(r,t)??i}buildGroupedItems(n,i,r){let t=new Map;for(let o of i){let c=V(o),a=c?b(c,r.labelKeys)??b(c,Object.keys(c))??"Unnamed":typeof o=="string"?o:"Unnamed",d=c?b(c,r.descriptionKeys)??void 0:void 0,w=c&&typeof c.configSource=="string"?c.configSource:void 0,y=[d,w==="project"?"Project config":w==="global"?"Workspace config":void 0].filter(h=>h&&h.length>0).join(" \u2022 "),f=c?vt(c):void 0,l=w==="project"?new p.ThemeIcon("notebook"):w==="global"?new p.ThemeIcon("globe"):r.iconPath,u={label:a,description:y.length>0?y:void 0,tooltip:f,contextValue:r.contextValue,itemKind:r.itemKind,workspaceFolder:n,data:c,iconPath:l,command:r.command},m;if(w==="project"||w==="global")m=w==="project"?`Local ${r.itemKind}s`:`Workspace ${r.itemKind}s`;else{let h=c?b(c,this.groupKeys):void 0;m=h&&h.trim().length>0?h.trim():"Ungrouped"}t.has(m)||t.set(m,[]),t.get(m)?.push(u)}if(t.size===1&&t.has("Ungrouped"))return(t.get("Ungrouped")??[]).sort((o,c)=>o.label.localeCompare(c.label));let s=[`Local ${r.itemKind}s`,`Workspace ${r.itemKind}s`];return Array.from(t.entries()).sort(([o],[c])=>{let a=s.indexOf(o),d=s.indexOf(c);return a!==-1||d!==-1?a===-1?1:d===-1?-1:a-d:o.localeCompare(c)}).map(([o,c])=>({label:o,collapsibleState:p.TreeItemCollapsibleState.Expanded,contextValue:"cumulusci.group",itemKind:"group",children:c.sort((a,d)=>a.label.localeCompare(d.label)),workspaceFolder:n}))}getOrgIcon(n){if(A(n,["definitionMissing"])===!0)return new p.ThemeIcon("circle-slash");if(A(n,["scratch","scratch_org","is_scratch","isScratch"])??!1){let r=A(n,["expired"]),t=A(n,["orgCreated","active","is_active"]),s=A(n,["definitionMissing"]);return r===!0||t===!1?this.icons.scratchInactive:s?this.icons.scratchInactive:this.icons.scratchActive}return A(n,["connected","is_connected"])===!0?this.icons.connected:this.icons.orgDefault}};function V(e){if(!(!e||typeof e!="object"||Array.isArray(e)))return e}function b(e,n){if(e)for(let i of n){let r=e[i];if(typeof r=="string"&&r.trim().length>0)return r.trim()}}function X(e){return e.trim()}function je(e){return X(e).toLowerCase()}function _n(e){return Array.isArray(e)?e.map(n=>typeof n=="string"?n.trim():"").filter(n=>n.length>0):typeof e=="string"&&e.trim().length>0?[e.trim()]:[]}function A(e,n){if(e)for(let i of n){let r=e[i];if(typeof r=="boolean")return r;if(typeof r=="string"){let t=r.trim().toLowerCase();if(["true","yes","1"].includes(t))return!0;if(["false","no","0"].includes(t))return!1}if(typeof r=="number")return r!==0}}function vt(e){let n=new p.MarkdownString;return n.isTrusted=!1,n.appendCodeblock(JSON.stringify(e,null,2),"json"),n}function Ct(e,n){let i=[],r=b(n,["username","user","email_address"]);r&&i.push(["Username",r]);let t=b(n,["instance_url","domain","login_url"]);t&&i.push(["Instance URL",t]);let s=b(n,["org_id","id"]);s&&i.push(["Org ID",s]);let o=b(n,["config_file","config"]);o&&i.push(["Definition File",o]);let c=b(n,["org_type"]);c&&i.push(["Org Type",c]);let a=A(n,["scratch","is_scratch"]);a!==void 0&&i.push(["Scratch Org",Dn(a)]);let d=A(n,["created","orgCreated"]);d!==void 0&&i.push(["Created",Dn(d)]);let w=Un(n.days);w&&i.push(["Days Remaining",w]);let g=b(n,["date_created"]);g&&i.push(["Date Created",g]);let y=b(n,["sfdx_alias"]);y&&i.push(["SFDX Alias",y]);let f=b(n,["namespace"]);f&&i.push(["Namespace",f]);let l=[`# Org: ${ee(e)}`,""];if(i.length>0){l.push("## Summary","","| Field | Value |","| --- | --- |");for(let[u,m]of i)l.push(`| ${ee(u)} | ${ee(m)} |`);l.push("")}return l.push("## Raw JSON","","```json"),l.push(JSON.stringify(n,null,2)),l.push("```"),l.join(`
`)}function xt(e,n,i){let r=[e];n&&r.push(n);let t=r.join(" \u2022 "),s=[`# Service: ${ee(t)}`,""];if(i.title&&i.title!==t&&s.push(`_CCI reference:_ ${ee(i.title)}`,""),i.entries.length===0)return s.push("_No attributes reported by CCI._"),s.join(`
`);s.push("| Field | Value |","| --- | --- |");for(let o of i.entries)s.push(`| ${ee(o.key)} | ${ee(o.value)} |`);return s.join(`
`)}function ee(e){return e.replace(/[|\\`*_{}\[\]()#+\-!.]/g,n=>`\\${n}`).replace(/\n/g,"<br/>")}function Dn(e){return e?"Yes":"No"}function ue(e){return e===1?"day":"days"}function Nn(e){if(!e)return{};let n=e.trim();if(!n)return{};let i=n.match(/^(\d+)\s*\/\s*(\d+)$/);if(i){let t=Number.parseInt(i[1],10),s=Number.parseInt(i[2],10);if(Number.isFinite(t)&&Number.isFinite(s)&&s>0)return{used:t,total:s,remaining:Math.max(s-t,0)}}let r=Number(n);if(Number.isFinite(r)){let t=Math.max(0,Math.floor(r));return{total:t,remaining:t}}return{}}function $n(e,n){if(!(n===void 0&&e===void 0))return n===void 0?e===void 0?void 0:`${e} ${ue(e)} left`:n===0?"Expired":e===void 0?`${n} ${ue(n)} left`:e===n?`${e} ${ue(e)} left`:`${e}/${n} ${ue(n)} left`}function xe(e){let n=e.trim();if(!n)return"Service";let i=n.split(/[_-]+/).filter(r=>r.length>0);return i.length===0?Pn(n):i.map(Pn).join(" ")}function Pn(e){switch(e.toLowerCase()){case"oauth2":return"OAuth2";case"github":return"GitHub";case"devhub":return"Dev Hub";case"metaci":return"MetaCI";case"metadeploy":return"MetaDeploy";case"sfdx":return"SFDX";default:return e.charAt(0).toUpperCase()+e.slice(1)}}function Un(e){if(e!=null){if(typeof e=="string"){let n=e.trim();return n.length>0?n:void 0}if(typeof e=="number"||typeof e=="boolean")return String(e);if(Array.isArray(e))return e.map(n=>Un(n)??"").filter(n=>n.length>0).join(", ");if(typeof e=="object")return JSON.stringify(e)}}function bt(e){let n=e.split(/\r?\n/).flatMap(r=>r.split(",")).map(r=>r.trim()).filter(r=>r.length>0),i=[];for(let r of n)i.push("-o"),i.push(r);return i}function St(e){let n=e.trim();if(!n)return[];let i=/"([^"\\]*(?:\\.[^"\\]*)*)"|'([^'\\]*(?:\\.[^'\\]*)*)'|[^\s]+/g,r=[],t;for(;(t=i.exec(n))!==null;){if(t[1]!==void 0){r.push(t[1].replace(/\\"/g,'"'));continue}if(t[2]!==void 0){r.push(t[2].replace(/\\'/g,"'"));continue}r.push(t[0])}return r}function be(e){return e?/[^A-Za-z0-9_@%+=:,./-]/.test(e)?`"${e.replace(/(["\\$`])/g,"\\$1")}"`:e:'""'}function L(e){if(e instanceof z)return e;if(Array.isArray(e)&&e[0]instanceof z)return e[0]}function W(e){let n=e.workspaceFolder;if(!n)throw new Error("Workspace folder not found for this item.");return n}function M(e,n,i){if(e.itemKind!==n)throw new Error(`${i} can only be used from a ${n} item.`)}function U(e){return e?typeof e=="string"?e:e.label:""}function kt(e){if(typeof e=="string")return e;if(typeof e=="boolean")return e?"true":"false";if(e&&typeof e=="object")return e.label}function At(e){let n=p.window.createOutputChannel("CumulusCI");e.subscriptions.push(n);let i=new Ue(e.extensionUri,n),r=p.window.createStatusBarItem(p.StatusBarAlignment.Left,100);r.name="CumulusCI Default Org",r.command="cumulusci.status.showDefaultOrg",r.text="$(organization) Loading\u2026",r.tooltip="Resolving default CCI org\u2026",r.show(),e.subscriptions.push(r);let t="cumulusci.expiryNotified",s=async(f,l)=>{let u=l.alias,m=l.data??{},h=e.workspaceState.get(t)??{},v=A(m,["is_scratch","scratch","scratch_org","isScratch"])??!1,x=A(m,["expired"])??!1,S=b(m,["days"]),{remaining:k,total:j}=Nn(S),E=$n(k,j)??"unknown remaining time",T=!1,G=()=>{u in h&&(delete h[u],T=!0)};if(!v)G();else if(x){if(h[u]!==-1){h[u]=-1,T=!0;let q=await p.window.showErrorMessage(`Default scratch org ${u} has expired (${E??"expired"}).`,"Open Org Info","Change Default");q==="Open Org Info"?await a(f,u):q==="Change Default"&&await p.commands.executeCommand("cumulusci.status.showDefaultOrg")}}else if(k!==void 0&&j!==void 0&&k<=2){if(h[u]!==k){h[u]=k,T=!0;let q=E??`${k} ${ue(k)} remaining`,fe=k===0?`Default scratch org ${u} expires today (${q}).`:`Default scratch org ${u} will expire soon (${q}).`,I=await p.window.showWarningMessage(fe,"Open Org Info","Change Default");I==="Open Org Info"?await a(f,u):I==="Change Default"&&await p.commands.executeCommand("cumulusci.status.showDefaultOrg")}}else G();T&&await e.workspaceState.update(t,h)},o=async()=>{try{let f=await i.findDefaultOrg();if(!f){n.appendLine("[status] No default org found; showing placeholder"),r.text="$(organization) No default org",r.tooltip="No default org set. Click to choose one.";let h=e.workspaceState.get(t)??{};Object.keys(h).length>0&&await e.workspaceState.update(t,{}),r.show();return}let l=f.entry.alias,u=f.entry.description??"",m=[`Default CCI Org: ${l}`,`Workspace: ${f.folder.name}`];u&&m.push(u),r.text=`$(organization) Default CCI Org: ${l}`,r.tooltip=m.join(`
`),r.show(),n.appendLine(`[status] Default org set to ${l}`),await s(f.folder,f.entry)}catch(f){let l=f instanceof Error?f.message:String(f);n.appendLine(`[status] Failed to resolve default org: ${l}`),r.text="$(organization) Org status unavailable",r.tooltip=l,r.show()}},c={orgs:new Z("orgs",i,e.extensionUri),tasks:new Z("tasks",i,e.extensionUri),flows:new Z("flows",i,e.extensionUri),project:new Z("project",i,e.extensionUri),services:new Z("services",i,e.extensionUri)},a=async(f,l)=>{let u=await i.getOrgInfo(f,l),m=Ct(l,u),h=await p.workspace.openTextDocument({language:"markdown",content:m});await p.window.showTextDocument(h,{preview:!0})},d=async(f,l)=>{let u=await i.getOrgQuickPickItems(f);if(u.length===0){let S=(await p.window.showInputBox({prompt:"Enter the org alias to use",placeHolder:"Org alias",ignoreFocusOut:!0}))?.trim();return S?{label:S,description:void 0,detail:"Custom alias",alias:S,orgCreated:!1,expired:!1,isScratch:!1,definitionOnly:!1,definitionMissing:!1,manual:!0}:void 0}let m=u.filter(x=>x.orgCreated&&!x.expired);if(m.length===1&&u.every(x=>x===m[0]||!x.orgCreated||x.expired))return m[0];let h={label:"$(edit) Enter another alias\u2026",description:"",detail:"Provide an alias not listed above",alias:"",orgCreated:!1,expired:!1,isScratch:!1,definitionOnly:!1,definitionMissing:!1,manual:!0},v=await p.window.showQuickPick([...u,h],{placeHolder:l,matchOnDetail:!0});if(v){if(v.manual){let S=(await p.window.showInputBox({prompt:"Enter the org alias to use",placeHolder:"Org alias",ignoreFocusOut:!0}))?.trim();return S?{...v,alias:S,manual:!1}:void 0}return v}},w=async f=>{if(f)return f;let l=await i.getProjectFolders();if(l.length===0){p.window.showWarningMessage("No CumulusCI project detected in the current workspace.");return}return l.length===1?l[0]:(await p.window.showQuickPick(l.map(m=>({label:m.name,description:m.uri.fsPath,folder:m})),{placeHolder:"Select a CCI project folder",matchOnDescription:!0}))?.folder},g=async()=>{let f=[{label:"Delete org after run",description:"(--delete-org)",flag:"--delete-org"},{label:"Enable debugger on error",description:"(--debug)",flag:"--debug"},{label:"Disable prompts",description:"(--no-prompt)",flag:"--no-prompt"}],l=await p.window.showQuickPick(f,{placeHolder:"Optional flags for this flow (press Enter to continue, Esc to cancel)",canPickMany:!0,ignoreFocusOut:!0});if(l===void 0)return;let u=l.map(v=>v.flag),m=await p.window.showInputBox({prompt:"Task options (-o task__option value). Enter one per line (optional).",placeHolder:"deploy_post__path ./src/\u2026",ignoreFocusOut:!0});if(m===void 0)return;u.push(...bt(m));let h=await p.window.showInputBox({prompt:"Additional CLI arguments (optional).",placeHolder:"--delete-org --no-prompt",ignoreFocusOut:!0});if(h!==void 0)return u.push(...St(h)),u};e.subscriptions.push(p.window.registerTreeDataProvider("cumulusci.orgs",c.orgs),p.window.registerTreeDataProvider("cumulusci.tasks",c.tasks),p.window.registerTreeDataProvider("cumulusci.flows",c.flows),p.window.registerTreeDataProvider("cumulusci.project",c.project),p.window.registerTreeDataProvider("cumulusci.services",c.services)),o();let y=f=>{c[f].refresh(),f==="orgs"&&o()};e.subscriptions.push(p.commands.registerCommand("cumulusci.refreshOrgs",()=>y("orgs")),p.commands.registerCommand("cumulusci.refreshTasks",()=>y("tasks")),p.commands.registerCommand("cumulusci.refreshFlows",()=>y("flows")),p.commands.registerCommand("cumulusci.refreshProjectInfo",()=>y("project")),p.commands.registerCommand("cumulusci.refreshServices",()=>y("services"))),e.subscriptions.push(p.commands.registerCommand("cumulusci.status.showDefaultOrg",async()=>{try{let f=await i.getProjectFolders();if(f.length===0){p.window.showWarningMessage("No CumulusCI projects detected in the current workspace.");return}let l=await i.findDefaultOrg(),u=[];for(let h of f){let v=await i.getOrgQuickPickItems(h);for(let x of v){let S=l!==void 0&&l.entry.alias===x.alias&&l.folder.uri.fsPath===h.uri.fsPath;u.push({label:x.label,description:h.name,detail:S?"Current default":x.detail,action:"set",alias:x.alias,folder:h})}}if(l&&u.unshift({label:"$(circle-slash) Clear default org",description:l.folder.name,detail:`Currently ${l.entry.alias}`,action:"clear",alias:l.entry.alias,folder:l.folder}),u.length===0){p.window.showInformationMessage("No orgs available to set as default.");return}let m=await p.window.showQuickPick(u,{placeHolder:l?"Select an org to make default or clear the current default":"Select an org to set as the CCI default",matchOnDescription:!0,matchOnDetail:!0});if(!m)return;if(m.action==="clear"){if(!m.folder)return;await p.window.withProgress({location:p.ProgressLocation.Window,title:"Clearing CCI default org\u2026"},async()=>{await i.runCciCommand(m.folder,["org","default","--unset"])}),p.window.showInformationMessage("Cleared the CCI default org."),y("orgs");return}if(!m.folder||!m.alias)return;await p.window.withProgress({location:p.ProgressLocation.Window,title:`Setting default org to ${m.alias}\u2026`},async()=>{await i.runCciCommand(m.folder,["org","default",m.alias])}),p.window.showInformationMessage(`Set ${m.alias} as the CCI default org.`),y("orgs")}catch(f){p.window.showErrorMessage(f instanceof Error?f.message:String(f))}}),p.commands.registerCommand("cumulusci.service.showInfo",async f=>{let l=L(f);if(l)try{M(l,"service","Show Service Info");let u=W(l),m=l.data??{},h=b(m,["type"]);if(!h)throw new Error("Service type is missing for this item.");let v=b(m,["name"]),x=b(m,["typeLabel"])??xe(h),S=await i.getServiceInfo(u,h,v),k=xt(x,v,S),j=await p.workspace.openTextDocument({language:"markdown",content:k});await p.window.showTextDocument(j,{preview:!0})}catch(u){p.window.showErrorMessage(u instanceof Error?u.message:String(u))}}),p.commands.registerCommand("cumulusci.service.connect",async f=>{try{let l=L(f),u=await w(l?.workspaceFolder);if(!u)return;let m=l?.data??{},h=b(m,["type"]),v=b(m,["typeLabel"]),x=Array.isArray(m.attributes)?m.attributes:[];if(!h){let I=await i.getServiceTypeGroups(u);if(I.length===0){p.window.showWarningMessage("CCI did not report any service types to connect.");return}let N=await p.window.showQuickPick(I.map($=>({label:$.label,description:$.description||void 0,detail:$.entries.length>0?`${$.entries.length} configured`:void 0,value:$.type,attributes:$.attributes})),{placeHolder:"Select a service type to connect",matchOnDescription:!0});if(!N)return;h=N.value,v=N.label,x=N.attributes}if(!h)return;if(x.length===0){let N=(await i.getServiceTypeGroups(u)).find($=>$.type===h);N&&(x=N.attributes,v||(v=N.label))}v||(v=xe(h));let S=await p.window.showInputBox({prompt:"Optional service name (press Enter to accept the default)",placeHolder:"Leave blank to let CCI decide",ignoreFocusOut:!0});if(S===void 0)return;let k=S.trim(),j=[{label:"Set as global default (--default)",description:"Applies to all projects",flag:"--default"},{label:"Set as project default (--project)",description:"Scoped to this workspace",flag:"--project"}],E=await p.window.showQuickPick(j,{placeHolder:"Select optional flags for this service (Esc to skip)",canPickMany:!0,ignoreFocusOut:!0});if(E===void 0)return;let T=["cci","service","connect",h];if(k.length>0&&T.push(be(k)),E&&E.length>0)for(let I of E)I.flag&&T.push(I.flag);let G=x.length>0;if(G)for(let I of x){let N=!!(I.defaultValue||I.defaultFactory),$=I.required&&!N,Kn=I.description??`Enter value for ${I.name}`,Wn=$?"Required":N?"Optional (leave blank to let CCI provide a default)":"Optional",de;for(;;){let Ke=await p.window.showInputBox({prompt:`${Wn}: ${Kn}`,placeHolder:N?"Leave blank to use CLI default":void 0,ignoreFocusOut:!0,value:I.sensitive?void 0:I.defaultValue,password:I.sensitive});if(Ke===void 0)return;let We=Ke.trim();if(We.length===0){if(I.defaultValue!==void 0){de=I.defaultValue;break}if($){await p.window.showErrorMessage(`A value is required for ${I.name}.`);continue}break}de=We;break}de!==void 0&&(T.push(`--${I.name}`),T.push(be(de)))}let q=v??xe(h),fe=p.window.createTerminal({name:`CCI: Connect ${q}`,cwd:u.uri});fe.show(!0),fe.sendText(T.join(" "),!0),G?p.window.showInformationMessage(`Opened a terminal to run "${T.join(" ")}". Review or adjust values in the terminal if needed.`):p.window.showInformationMessage(`Opened a terminal to run "${T.join(" ")}".`)}catch(l){p.window.showErrorMessage(l instanceof Error?l.message:String(l))}}),p.commands.registerCommand("cumulusci.service.setDefault",async f=>{let l=L(f);if(l)try{M(l,"service","Set Service Default");let u=W(l),m=l.data??{},h=b(m,["type"]),v=b(m,["name"]);if(!h||!v)throw new Error("Service type or name is missing.");let x=await p.window.showQuickPick([{label:"Global default",description:"Applies to all projects",flag:void 0},{label:"Project default",description:"Applies only to this workspace",flag:"--project"}],{placeHolder:"Select default scope"});if(!x)return;let S=["service","default"];x.flag&&S.push(x.flag),S.push(h,v);let k=await i.runCciCommand(u,S);k.trim().length>0&&(n.appendLine(k.trim()),n.show(!0)),y("services")}catch(u){p.window.showErrorMessage(u instanceof Error?u.message:String(u))}}),p.commands.registerCommand("cumulusci.service.remove",async f=>{let l=L(f);if(l)try{M(l,"service","Remove Service");let u=W(l),m=l.data??{},h=b(m,["type"]),v=b(m,["name"]);if(!h||!v)throw new Error("Service type or name is missing.");let x=U(l.label)||v;if(await p.window.showWarningMessage(`Remove service "${x}" (${h})?`,{modal:!0},"Remove")!=="Remove")return;await i.runCciCommand(u,["service","remove",h,v]),p.window.showInformationMessage(`Removed service "${x}" (${h}).`),y("services")}catch(u){p.window.showErrorMessage(u instanceof Error?u.message:String(u))}}),p.commands.registerCommand("cumulusci.service.rename",async f=>{let l=L(f);if(l)try{M(l,"service","Rename Service");let u=W(l),m=l.data??{},h=b(m,["type"]),v=b(m,["name"]);if(!h||!v)throw new Error("Service type or name is missing.");let x=await p.window.showInputBox({prompt:"Enter the new service name",value:v,ignoreFocusOut:!0});if(x===void 0)return;let S=x.trim();if(!S||S===v)return;await i.runCciCommand(u,["service","rename",h,v,S]),y("services")}catch(u){p.window.showErrorMessage(u instanceof Error?u.message:String(u))}})),e.subscriptions.push(p.commands.registerCommand("cumulusci.runTask",async f=>{try{let l=L(f);if(!l)return;M(l,"task","Run Task");let u=W(l),m=U(l.label)||"task",h=b(l.data,["name","task_name"])??m,v=`CCI Task: ${h}`,x=p.window.terminals.find(S=>S.name===v);x||(x=p.window.createTerminal({name:v,cwd:u.uri})),x.show(),x.sendText(`cci task run ${h} `,!1)}catch(l){p.window.showErrorMessage(l instanceof Error?l.message:String(l))}}),p.commands.registerCommand("cumulusci.copyTaskCommand",async f=>{let l=L(f);if(l)try{M(l,"task","Copy Task Command");let u=U(l.label)||"task",m=b(l.data,["name","task_name"])??u;await p.env.clipboard.writeText(`cci task run ${m}`),p.window.showInformationMessage(`Copied: cci task run ${m}`)}catch(u){p.window.showErrorMessage(u instanceof Error?u.message:String(u))}}),p.commands.registerCommand("cumulusci.runFlow",async f=>{let l=L(f);if(l)try{M(l,"flow","Run Flow");let u=W(l),m=U(l.label)||"flow",h=b(l.data,["name","flow"])??m,v=await d(u,"Select an org to run this flow against");if(!v)return;let x=v.alias.trim();if(!x)return;let S=await g();if(S===void 0)return;let j=["cci","flow","run",h,"--org",x,...S].map(be).join(" ");await p.window.withProgress({location:p.ProgressLocation.Notification,title:`Running flow ${h} against ${x}`},async()=>{let E=`CCI Flow: ${h}`,T=p.window.terminals.find(G=>G.name===E);T||(T=p.window.createTerminal({name:E,cwd:u.uri})),T.show(),T.sendText(j)})}catch(u){p.window.showErrorMessage(u instanceof Error?u.message:String(u))}}),p.commands.registerCommand("cumulusci.copyFlowCommand",async f=>{let l=L(f);if(l)try{M(l,"flow","Copy Flow Command");let u=U(l.label)||"flow",m=b(l.data,["name","flow"])??u;await p.env.clipboard.writeText(`cci flow run ${m} --org <org>`),p.window.showInformationMessage(`Copied: cci flow run ${m} --org <org>`)}catch(u){p.window.showErrorMessage(u instanceof Error?u.message:String(u))}}),p.commands.registerCommand("cumulusci.org.showActions",async f=>{let l=L(f);if(l)try{M(l,"org","Org Actions");let u=W(l),m=U(l.label)||"org",h=b(l.data,["alias","name","org_name","config_name"])??m,v=kt(l.description),x=v?` (${v})`:"",S={label:h,description:v,detail:void 0,alias:h,data:l.data,orgCreated:A(l.data,["orgCreated"])??!1,expired:A(l.data,["expired"])??!1,isScratch:A(l.data,["scratch","scratch_org","is_scratch","isScratch"])??!1,definitionOnly:A(l.data,["definitionOnly"])??!1,definitionMissing:A(l.data,["definitionMissing"])??!1,manual:!1},k=[{...S,label:"Open in Browser",detail:`cci org browser ${h}`,action:"open"},{...S,label:"Show Org Info",detail:`cci org info ${h}`,action:"info"},{...S,label:"Set as Default Org",detail:`cci org default ${h}`,action:"default"},{...S,label:"Copy Org Alias",detail:h,action:"copy"}],j=await p.window.showQuickPick(k,{placeHolder:`Choose an action for ${h}${x}`});if(!j)return;switch(j.action){case"open":{n.appendLine(`$ cci org browser ${h}`),await i.runCciCommand(u,["org","browser",h]);break}case"info":{await a(u,h);break}case"default":{n.appendLine(`$ cci org default ${h}`);let E=await i.runCciCommand(u,["org","default",h]);E.trim().length>0&&(n.appendLine(E.trim()),n.show(!0)),y("orgs");break}case"copy":{await p.env.clipboard.writeText(h),p.window.showInformationMessage(`Copied org alias: ${h}`);break}}}catch(u){p.window.showErrorMessage(u instanceof Error?u.message:String(u))}}),p.commands.registerCommand("cumulusci.org.openInBrowser",async f=>{let l=L(f);if(l)try{M(l,"org","Open Org in Browser");let u=W(l),m=U(l.label)||"org",h=b(l.data,["alias","name","org_name","config_name"])??m;n.appendLine(`$ cci org browser ${h}`),await i.runCciCommand(u,["org","browser",h])}catch(u){p.window.showErrorMessage(u instanceof Error?u.message:String(u))}}),p.commands.registerCommand("cumulusci.org.showInfo",async f=>{let l=L(f);if(l)try{M(l,"org","Show Org Info");let u=W(l),m=U(l.label)||"org",h=b(l.data,["alias","name","org_name","config_name"])??m;n.appendLine(`$ cci org info ${h} --json`),await a(u,h)}catch(u){p.window.showErrorMessage(u instanceof Error?u.message:String(u))}}),p.commands.registerCommand("cumulusci.org.setDefault",async f=>{let l=L(f);if(l)try{M(l,"org","Set Default Org");let u=W(l),m=U(l.label)||"org",h=b(l.data,["alias","name","org_name","config_name"])??m;n.appendLine(`$ cci org default ${h}`);let v=await i.runCciCommand(u,["org","default",h]);v.trim().length>0&&(n.appendLine(v.trim()),n.show(!0)),y("orgs")}catch(u){p.window.showErrorMessage(u instanceof Error?u.message:String(u))}}),p.commands.registerCommand("cumulusci.copyOrgAlias",async f=>{let l=L(f);if(l)try{M(l,"org","Copy Org Alias");let u=U(l.label)||"org",m=b(l.data,["alias","name","org_name","config_name"])??u;await p.env.clipboard.writeText(m),p.window.showInformationMessage(`Copied org alias: ${m}`)}catch(u){p.window.showErrorMessage(u instanceof Error?u.message:String(u))}})),e.subscriptions.push(p.commands.registerCommand("cumulusci.helloWorld",()=>{p.window.showInformationMessage("Hello World from cumulusci!")})),e.subscriptions.push(p.workspace.onDidChangeWorkspaceFolders(()=>{y("orgs"),y("tasks"),y("flows"),y("project"),y("services")}))}function It(){}0&&(module.exports={activate,deactivate});
/*! Bundled license information:

js-yaml/dist/js-yaml.mjs:
  (*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT *)
*/
